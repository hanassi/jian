======================================================================
                      UNIX/Linux Security Check
======================================================================

======================================================================
                            INFO_CHK START
======================================================================

[Start Time]
Tue Jul  1 15:56:26 KST 2025
======================================================================
                             INFO_CHK END
======================================================================


======================================================================
                    System Information Query Start
======================================================================

[Kernel Information]
Linux mail.jian.local 5.14.0-590.el9.x86_64 #1 SMP PREEMPT_DYNAMIC Fri May 30 21:16:05 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux

[IP Information]
ens160: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.10.100  netmask 255.255.255.0  broadcast 192.168.10.255
        inet6 fe80::20c:29ff:febe:3422  prefixlen 64  scopeid 0x20<link>
        ether 00:0c:29:be:34:22  txqueuelen 1000  (Ethernet)
        RX packets 24084  bytes 7973421 (7.6 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 44006  bytes 28833170 (27.4 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 1410  bytes 100844 (98.4 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 1410  bytes 100844 (98.4 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0


[Network Status]
Active Internet connections (servers and established)
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:25              0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:953           0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:2049            0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:53            0.0.0.0:*               LISTEN     
tcp        0      0 192.168.10.100:53       0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:39767           0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:44869           0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:20048           0.0.0.0:*               LISTEN     
tcp        0      0 192.168.10.100:22       192.168.10.1:56757      ESTABLISHED
tcp        0      0 192.168.10.100:22       192.168.10.1:56803      ESTABLISHED
tcp6       0      0 ::1:53                  :::*                    LISTEN     
tcp6       0      0 :::80                   :::*                    LISTEN     
tcp6       0      0 :::111                  :::*                    LISTEN     
tcp6       0      0 :::22                   :::*                    LISTEN     
tcp6       0      0 :::21                   :::*                    LISTEN     
tcp6       0      0 :::2049                 :::*                    LISTEN     
tcp6       0      0 ::1:953                 :::*                    LISTEN     
tcp6       0      0 :::20048                :::*                    LISTEN     
tcp6       0      0 :::53861                :::*                    LISTEN     
tcp6       0      0 :::33293                :::*                    LISTEN     
udp        0      0 192.168.10.100:68       192.168.10.254:67       ESTABLISHED
Active UNIX domain sockets (servers and established)
unix  2      [ ACC ]     STREAM     LISTENING     28283    /run/gssproxy.sock
unix  2      [ ACC ]     STREAM     LISTENING     7121144  /run/user/1000/systemd/private
unix  2      [ ACC ]     STREAM     LISTENING     7121156  /run/user/1000/bus
unix  2      [ ACC ]     STREAM     LISTENING     23671    /run/systemd/private
unix  2      [ ACC ]     STREAM     LISTENING     23684    /run/lvm/lvmpolld.socket
unix  2      [ ACC ]     STREAM     LISTENING     23686    /run/rpcbind.sock
unix  2      [ ACC ]     SEQPACKET  LISTENING     23696    /run/systemd/coredump
unix  2      [ ACC ]     SEQPACKET  LISTENING     23698    /run/udev/control
unix  2      [ ACC ]     STREAM     LISTENING     16339    /run/systemd/userdb/io.systemd.DynamicUser
unix  2      [ ACC ]     STREAM     LISTENING     16340    /run/systemd/io.system.ManagedOOM
unix  2      [ ACC ]     STREAM     LISTENING     16351    /run/systemd/journal/stdout
unix  2      [ ACC ]     STREAM     LISTENING     18978    /run/systemd/journal/io.systemd.journal
unix  2      [ ACC ]     STREAM     LISTENING     27675    @ISCSID_UIP_ABSTRACT_NAMESPACE
unix  2      [ ACC ]     STREAM     LISTENING     28282    /var/lib/gssproxy/default.sock
unix  2      [ ACC ]     STREAM     LISTENING     31439    /etc/httpd/run/cgisock.902
unix  2      [ ACC ]     STREAM     LISTENING     27673    /run/dbus/system_bus_socket
unix  2      [ ACC ]     STREAM     LISTENING     27676    /run/.heim_org.h5l.kcm-socket
unix  2      [ ACC ]     STREAM     LISTENING     27722    /var/run/lsm/ipc/sim
unix  2      [ ACC ]     STREAM     LISTENING     27723    /var/run/lsm/ipc/simc
unix  2      [ ACC ]     STREAM     LISTENING     27745    /var/run/mcelog-client
unix  2      [ ACC ]     STREAM     LISTENING     27674    @ISCSIADM_ABSTRACT_NAMESPACE
unix  2      [ ACC ]     STREAM     LISTENING     28702    /var/run/vmware/guestServicePipe
Active Bluetooth connections (servers and established)

[Routing Information]
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
0.0.0.0         192.168.10.2    0.0.0.0         UG        0 0          0 ens160
192.168.10.0    0.0.0.0         255.255.255.0   U         0 0          0 ens160

[Process Status]
UID          PID    PPID  C STIME TTY          TIME CMD
root           1       0  0 Jun30 ?        00:00:56 /usr/lib/systemd/systemd rhgb --switched-root --system --deserialize 31
root           2       0  0 Jun30 ?        00:00:00 [kthreadd]
root           3       2  0 Jun30 ?        00:00:00 [pool_workqueue_]
root           4       2  0 Jun30 ?        00:00:00 [kworker/R-rcu_g]
root           5       2  0 Jun30 ?        00:00:00 [kworker/R-sync_]
root           6       2  0 Jun30 ?        00:00:00 [kworker/R-slub_]
root           7       2  0 Jun30 ?        00:00:00 [kworker/R-netns]
root           9       2  0 Jun30 ?        00:00:00 [kworker/0:0H-events_highpri]
root          11       2  0 Jun30 ?        00:00:00 [kworker/R-mm_pe]
root          12       2  0 Jun30 ?        00:00:00 [kworker/u512:1-netns]
root          13       2  0 Jun30 ?        00:00:00 [rcu_tasks_kthre]
root          14       2  0 Jun30 ?        00:00:00 [rcu_tasks_rude_]
root          15       2  0 Jun30 ?        00:00:00 [rcu_tasks_trace]
root          16       2  0 Jun30 ?        00:00:05 [ksoftirqd/0]
root          17       2  0 Jun30 ?        00:00:03 [rcu_preempt]
root          18       2  0 Jun30 ?        00:00:00 [rcu_exp_par_gp_]
root          19       2  0 Jun30 ?        00:00:00 [rcu_exp_gp_kthr]
root          20       2  0 Jun30 ?        00:00:00 [migration/0]
root          21       2  0 Jun30 ?        00:00:00 [idle_inject/0]
root          23       2  0 Jun30 ?        00:00:00 [cpuhp/0]
root          24       2  0 Jun30 ?        00:00:00 [cpuhp/1]
root          25       2  0 Jun30 ?        00:00:00 [idle_inject/1]
root          26       2  0 Jun30 ?        00:00:00 [migration/1]
root          27       2  0 Jun30 ?        00:00:03 [ksoftirqd/1]
root          34       2  0 Jun30 ?        00:00:00 [kdevtmpfs]
root          35       2  0 Jun30 ?        00:00:00 [kworker/R-inet_]
root          36       2  0 Jun30 ?        00:00:00 [kauditd]
root          37       2  0 Jun30 ?        00:00:00 [khungtaskd]
root          39       2  0 Jun30 ?        00:00:00 [oom_reaper]
root          40       2  0 Jun30 ?        00:00:00 [kworker/R-write]
root          41       2  0 Jun30 ?        00:00:01 [kcompactd0]
root          42       2  0 Jun30 ?        00:00:00 [ksmd]
root          43       2  0 Jun30 ?        00:00:02 [khugepaged]
root          44       2  0 Jun30 ?        00:00:00 [kworker/R-crypt]
root          45       2  0 Jun30 ?        00:00:00 [kworker/R-kinte]
root          46       2  0 Jun30 ?        00:00:00 [kworker/R-kbloc]
root          47       2  0 Jun30 ?        00:00:00 [irq/9-acpi]
root          49       2  0 Jun30 ?        00:00:00 [kworker/R-tpm_d]
root          50       2  0 Jun30 ?        00:00:00 [kworker/R-md]
root          51       2  0 Jun30 ?        00:00:00 [kworker/R-md_bi]
root          52       2  0 Jun30 ?        00:00:00 [kworker/R-edac-]
root          53       2  0 Jun30 ?        00:00:00 [watchdogd]
root          54       2  0 Jun30 ?        00:00:00 [kworker/1:1H-kblockd]
root          55       2  0 Jun30 ?        00:00:00 [kswapd0]
root          72       2  0 Jun30 ?        00:00:00 [kworker/R-kthro]
root          76       2  0 Jun30 ?        00:00:00 [irq/24-pciehp]
root          77       2  0 Jun30 ?        00:00:00 [irq/25-pciehp]
root          78       2  0 Jun30 ?        00:00:00 [irq/26-pciehp]
root          79       2  0 Jun30 ?        00:00:00 [irq/27-pciehp]
root          80       2  0 Jun30 ?        00:00:00 [irq/28-pciehp]
root          81       2  0 Jun30 ?        00:00:00 [irq/29-pciehp]
root          82       2  0 Jun30 ?        00:00:00 [irq/30-pciehp]
root          83       2  0 Jun30 ?        00:00:00 [irq/31-pciehp]
root          84       2  0 Jun30 ?        00:00:00 [irq/32-pciehp]
root          85       2  0 Jun30 ?        00:00:00 [irq/33-pciehp]
root          86       2  0 Jun30 ?        00:00:00 [irq/34-pciehp]
root          87       2  0 Jun30 ?        00:00:00 [irq/35-pciehp]
root          88       2  0 Jun30 ?        00:00:00 [irq/36-pciehp]
root          89       2  0 Jun30 ?        00:00:00 [irq/37-pciehp]
root          90       2  0 Jun30 ?        00:00:00 [irq/38-pciehp]
root          91       2  0 Jun30 ?        00:00:00 [irq/39-pciehp]
root          92       2  0 Jun30 ?        00:00:00 [irq/40-pciehp]
root          93       2  0 Jun30 ?        00:00:00 [irq/41-pciehp]
root          94       2  0 Jun30 ?        00:00:00 [irq/42-pciehp]
root          95       2  0 Jun30 ?        00:00:00 [irq/43-pciehp]
root          96       2  0 Jun30 ?        00:00:00 [irq/44-pciehp]
root          97       2  0 Jun30 ?        00:00:00 [irq/45-pciehp]
root          98       2  0 Jun30 ?        00:00:00 [irq/46-pciehp]
root          99       2  0 Jun30 ?        00:00:00 [irq/47-pciehp]
root         100       2  0 Jun30 ?        00:00:00 [irq/48-pciehp]
root         101       2  0 Jun30 ?        00:00:00 [irq/49-pciehp]
root         102       2  0 Jun30 ?        00:00:00 [irq/50-pciehp]
root         103       2  0 Jun30 ?        00:00:00 [irq/51-pciehp]
root         104       2  0 Jun30 ?        00:00:00 [irq/52-pciehp]
root         105       2  0 Jun30 ?        00:00:00 [irq/53-pciehp]
root         106       2  0 Jun30 ?        00:00:00 [irq/54-pciehp]
root         107       2  0 Jun30 ?        00:00:00 [irq/55-pciehp]
root         108       2  0 Jun30 ?        00:00:00 [kworker/R-acpi_]
root         109       2  0 Jun30 ?        00:00:00 [kworker/R-kmpat]
root         110       2  0 Jun30 ?        00:00:00 [kworker/R-kalua]
root         112       2  0 Jun30 ?        00:00:00 [kworker/R-mld]
root         113       2  0 Jun30 ?        00:00:00 [kworker/R-ipv6_]
root         118       2  0 Jun30 ?        00:00:00 [kworker/R-kstrp]
root         124       2  0 Jun30 ?        00:00:00 [kworker/u515:0]
root         125       2  0 Jun30 ?        00:00:00 [kworker/u516:0]
root         126       2  0 Jun30 ?        00:00:00 [kworker/u517:0]
root         271       2  0 Jun30 ?        00:00:00 [kworker/0:1H-kblockd]
root         413       2  0 Jun30 ?        00:00:00 [kworker/R-nvme-]
root         415       2  0 Jun30 ?        00:00:00 [kworker/R-nvme-]
root         417       2  0 Jun30 ?        00:00:00 [kworker/R-nvme-]
root         418       2  0 Jun30 ?        00:00:00 [kworker/R-nvme-]
root         420       2  0 Jun30 ?        00:00:00 [kworker/R-ata_s]
root         421       2  0 Jun30 ?        00:00:00 [scsi_eh_0]
root         422       2  0 Jun30 ?        00:00:00 [kworker/R-scsi_]
root         423       2  0 Jun30 ?        00:00:00 [scsi_eh_1]
root         424       2  0 Jun30 ?        00:00:00 [kworker/R-scsi_]
root         427       2  0 Jun30 ?        00:00:00 [irq/16-vmwgfx]
root         428       2  0 Jun30 ?        00:00:00 [kworker/R-ttm]
root         443       2  0 Jun30 ?        00:00:00 [kworker/1:2H-kblockd]
root         455       2  0 Jun30 ?        00:00:00 [kworker/R-xfsal]
root         456       2  0 Jun30 ?        00:00:00 [kworker/R-xfs_m]
root         457       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-b]
root         458       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-c]
root         459       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-r]
root         460       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-b]
root         461       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-i]
root         462       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-l]
root         463       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-c]
root         464       2  0 Jun30 ?        00:00:16 [xfsaild/nvme0n1]
root         556       1  0 Jun30 ?        00:00:07 /usr/lib/systemd/systemd-journald
root         564       2  0 Jun30 ?        00:00:00 [kworker/R-rpcio]
root         565       2  0 Jun30 ?        00:00:00 [kworker/R-xprti]
root         572       1  0 Jun30 ?        00:00:00 /usr/lib/systemd/systemd-udevd
root         599       2  0 Jun30 ?        00:00:01 [irq/75-vmw_vmci]
root         600       2  0 Jun30 ?        00:00:00 [irq/76-vmw_vmci]
root         601       2  0 Jun30 ?        00:00:00 [irq/77-vmw_vmci]
root         623       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-b]
root         624       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-b]
root         625       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-c]
root         626       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-c]
root         627       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-r]
root         628       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-r]
root         629       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-b]
root         630       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-b]
root         631       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-i]
root         632       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-i]
root         633       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-l]
root         634       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-c]
root         635       2  0 Jun30 ?        00:00:00 [xfsaild/nvme0n1]
root         636       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-l]
root         637       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-c]
root         638       2  0 Jun30 ?        00:00:15 [xfsaild/nvme0n1]
rpc          644       1  0 Jun30 ?        00:00:00 /usr/bin/rpcbind -w -f
root         647       1  0 Jun30 ?        00:00:00 /usr/sbin/nfsdcld
root         648       1  0 Jun30 ?        00:00:00 /usr/sbin/rpc.idmapd
root         649       1  0 Jun30 ?        00:00:02 /sbin/auditd
root         651     649  0 Jun30 ?        00:00:00 /usr/sbin/sedispatch
dbus         677       1  0 Jun30 ?        00:00:00 /usr/bin/dbus-broker-launch --scope system --audit
dbus         678     677  0 Jun30 ?        00:00:13 dbus-broker --log 4 --controller 9 --machine-id c41ad224b687452ba82cf3d1fb24d946 --max-bytes 536870912 --max-fds 4096 --max-matches 131072 --audit
root         681       1  0 Jun30 ?        00:00:00 /usr/bin/python3 -s /usr/sbin/firewalld --nofork --nopid
root         682       1  0 Jun30 ?        00:00:05 /usr/sbin/irqbalance
libstor+     683       1  0 Jun30 ?        00:00:00 /usr/bin/lsmd -d
root         684       1  0 Jun30 ?        00:00:00 /usr/sbin/mcelog --daemon --foreground
root         686       1  0 Jun30 ?        00:00:12 /usr/lib/systemd/systemd-logind
root         688       1  0 Jun30 ?        00:00:00 /usr/bin/VGAuthService -s
root         689       1  0 Jun30 ?        00:03:27 /usr/bin/vmtoolsd
chrony       698       1  0 Jun30 ?        00:00:00 /usr/sbin/chronyd -F 2
root         753       1  0 Jun30 ?        00:00:07 /usr/sbin/NetworkManager --no-daemon
root         788       1  0 Jun30 ?        00:00:00 sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups
root         789       1  0 Jun30 ?        00:00:00 /usr/sbin/gssproxy -D
named        816       1  0 Jun30 ?        00:00:02 /usr/sbin/named -u named -c /etc/named.conf
polkitd      876       1  0 Jun30 ?        00:00:03 /usr/lib/polkit-1/polkitd --no-debug
root         893       1  0 Jun30 ?        00:00:14 /usr/sbin/rsyslogd -n
rpcuser      895       1  0 Jun30 ?        00:00:00 /usr/sbin/rpc.statd
root         896       1  0 Jun30 ?        00:00:00 /usr/sbin/rpc.mountd
root         902       1  0 Jun30 ?        00:00:07 /usr/sbin/httpd -DFOREGROUND
root         903       1  0 Jun30 ?        00:00:00 /usr/sbin/vsftpd /etc/vsftpd/vsftpd.conf
root         918       1  0 Jun30 ?        00:00:00 /usr/sbin/atd -f
root         921       1  0 Jun30 ?        00:00:01 /usr/sbin/crond -n
root         939       1  0 Jun30 tty1     00:00:00 /sbin/agetty -o -p -- \u --noclear - linux
root         954       2  0 Jun30 ?        00:00:00 [kworker/R-ib-co]
root         957       2  0 Jun30 ?        00:00:00 [kworker/R-ib-co]
root         959       2  0 Jun30 ?        00:00:00 [kworker/R-ib_mc]
root         960       2  0 Jun30 ?        00:00:00 [kworker/R-ib_nl]
root         971       2  0 Jun30 ?        00:00:00 [kworker/R-iw_cm]
root         976       2  0 Jun30 ?        00:00:00 [kworker/R-rdma_]
root         993       2  0 Jun30 ?        00:00:00 [lockd]
root        1059       2  0 Jun30 ?        00:00:00 [nfsd]
root        1060       2  0 Jun30 ?        00:00:00 [nfsd]
root        1061       2  0 Jun30 ?        00:00:00 [nfsd]
root        1062       2  0 Jun30 ?        00:00:00 [nfsd]
root        1063       2  0 Jun30 ?        00:00:00 [nfsd]
root        1064       2  0 Jun30 ?        00:00:00 [nfsd]
root        1065       2  0 Jun30 ?        00:00:00 [nfsd]
root        1066       2  0 Jun30 ?        00:00:00 [nfsd]
apache      1168     902  0 Jun30 ?        00:00:00 /usr/sbin/httpd -DFOREGROUND
apache      1169     902  0 Jun30 ?        00:00:27 /usr/sbin/httpd -DFOREGROUND
apache      1170     902  0 Jun30 ?        00:00:25 /usr/sbin/httpd -DFOREGROUND
apache      1190     902  0 Jun30 ?        00:00:24 /usr/sbin/httpd -DFOREGROUND
root        2207       2  0 Jun30 ?        00:00:00 [kworker/R-tls-s]
root       55759       2  0 10:01 ?        00:00:00 [kworker/u512:2-gid-cache-wq]
root       55791       1  0 10:01 ?        00:00:01 sendmail: accepting connections
smmsp      55798       1  0 10:01 ?        00:00:00 sendmail: Queue runner@01:00:00 for /var/spool/clientmqueue
root       55858     788  0 10:01 ?        00:00:00 sshd: jian [priv]
jian       55864       1  0 10:01 ?        00:00:00 /usr/lib/systemd/systemd --user
jian       55866   55864  0 10:01 ?        00:00:00 (sd-pam)
jian       55879   55858  0 10:01 ?        00:00:00 sshd: jian@notty
jian       55880   55879  0 10:01 ?        00:00:00 /usr/libexec/openssh/sftp-server
root       55903     788  0 10:01 ?        00:00:00 sshd: jian [priv]
jian       55908   55903  0 10:02 ?        00:00:01 sshd: jian@pts/0
jian       55909   55908  0 10:02 pts/0    00:00:00 -bash
root       55961   55909  0 10:02 pts/0    00:00:00 sudo su
root       55965   55961  0 10:02 pts/0    00:00:00 su
root       55966   55965  0 10:02 pts/0    00:00:00 bash
root       84531       2  0 14:46 ?        00:00:06 [kworker/1:3-cgroup_destroy]
root       87903       2  0 15:37 ?        00:00:00 [kworker/u514:3-events_unbound]
root       87913       2  0 15:38 ?        00:00:00 [kworker/0:4-events]
root       87930       2  0 15:38 ?        00:00:00 [kworker/u513:1-events_unbound]
root       88043       2  0 15:40 ?        00:00:01 [kworker/1:0-events]
root       88106       2  0 15:42 ?        00:00:00 [kworker/u514:2-events_unbound]
root       88130       2  0 15:43 ?        00:00:00 [kworker/0:2-mm_percpu_wq]
root       89003       2  0 15:44 ?        00:00:00 [kworker/0:3-events]
root       89004       2  0 15:44 ?        00:00:00 [kworker/u513:4-xfs-cil/nvme0n1p5]
root       89046       2  0 15:45 ?        00:00:01 [kworker/1:2-cgroup_destroy]
root       89127       2  0 15:48 ?        00:00:00 [kworker/u514:0-events_unbound]
root       90049       2  0 15:51 ?        00:00:00 [kworker/1:1-events]
root       90065       2  0 15:51 ?        00:00:00 [kworker/u513:0-events_unbound]
root       90088       2  0 15:52 ?        00:00:00 [kworker/0:0-events]
root       90098       2  0 15:53 ?        00:00:00 [kworker/1:4-cgroup_destroy]
root       90138       2  0 15:54 ?        00:00:00 [kworker/0:1]
root       90139       2  0 15:54 ?        00:00:00 [kworker/u514:1]
root       91056   55966  0 15:56 pts/0    00:00:00 bash ./2025_Unix_1.6_??????.sh
root       91095   91056  0 15:56 pts/0    00:00:00 ps -ef

[User Environment]
SHELL=/bin/bash
SUDO_GID=1000
HOSTNAME=mail.jian.local
HISTSIZE=1000
SUDO_COMMAND=/bin/su
SUDO_USER=jian
PWD=/home/jian
LOGNAME=root
HOME=/root
LANG=C
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:
SHELL_SWITCHED=1
TERM=xterm
LESSOPEN=||/usr/bin/lesspipe.sh %s
USER=root
SHLVL=2
DEBUGINFOD_URLS=https://debuginfod.centos.org/ 
DEBUGINFOD_IMA_CERT_PATH=/etc/keys/ima:
which_declare=declare -f
PATH=/root/.local/bin:/root/bin:/sbin:/bin:/usr/sbin:/usr/bin
SUDO_UID=1000
MAIL=/var/spool/mail/jian
OLDPWD=/home/jian/test
BASH_FUNC_which%%=() {  ( alias;
 eval ${which_declare} ) | /usr/bin/which --tty-only --read-alias --read-functions --show-tilde --show-dot $@
}
_=/bin/env

======================================================================
                     System Information Query End
======================================================================

======================================================================
                         Security Check START
======================================================================

[U-01] root 계정 원격 접속 제한
[U-01_START]
=============================================
[+] Telnet 프로세스 확인
[+] Telnet 프로세스가 비실행 중 입니다.

[+] pts/x 확인
/etc/securetty 파일이 존재하지 않습니다.

[+] pam_securetty.so 확인
[+] pam_securetty 모듈이 주석처리 되어있거나 설정 값이 존재하지 않습니다.

[+] SSH 프로세스 확인
root         788       1  0 Jun30 ?        00:00:00 sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups
root       55858     788  0 10:01 ?        00:00:00 sshd: jian [priv]
jian       55879   55858  0 10:01 ?        00:00:00 sshd: jian@notty

[+] /etc/ssh/sshd 설정 현황(PermitRootLogin)
해당 설정이 존재하지 않습니다.


[U-01_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 양호 : 원격 터미널 서비스를 사용하지 않거나, 사용 시 root 직접 접속을 차단한 경우 
 취약 : 원격 터미널 서비스 사용 시 root 직접 접속을 허용한 경우 
 취약 1. : Telnet 사용 시, /etc/default/login 파일에 CONSOLE=/dev/console이 없거나 주석처리 되어있을 경우 
 취약 2. : SSH 사용 시, /etc/ssh/sshd_config 파일에 PermitRootLogin yes로 설정되어 있을 경우 
******* 참고 사항 *******
 1. 'auth [user_unknown=ignore success=ok ignore=ignore default=bad] pam_securetty.so' 해당 설정 양호로 진단 (주석처리 주의)
=============================================




[U-02] 패스워드 복잡성 설정
[U-02_START]
=============================================
[+] 1. /etc/pam.d/system-auth 현황
password    requisite                                    pam_pwquality.so local_users_only
password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
password    [success=1 default=ignore]                   pam_localuser.so
password    sufficient                                   pam_sss.so use_authtok
password    required                                     pam_deny.so

[+] 2. /etc/pam.d/common-password 현황
파일이 존재하지 않습니다.

[+] 3. 현황 : /etc/security/pwquality.conf 상세 내용
minlen = 10 
# dcredit = 0
# ucredit = 0
# lcredit = 0
# ocredit = 0
minclass = 2 

[+] 4. 현황 : /etc/login.defs 상세 내용
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
#	PASS_MIN_LEN	Minimum acceptable password length.
#	PASS_WARN_AGE	Number of days warning given before a password expires.
PASS_MAX_DAYS	90
PASS_MIN_DAYS	1
PASS_WARN_AGE	7
# Currently PASS_MIN_LEN is not supported
# Currently PASS_CHANGE_TRIES is not supported
# Currently PASS_ALWAYS_WARN is not supported
# Currently PASS_MAX_LEN is not supported



[U-02_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
[*] 주석처리 주의 
[*] ※ 정책 기준: 영문 숫자 특수문자 2개 조합 시 10자리 이상, 3개 조합 시 8자리 이상, 패스워드 변경 기간 90일 이하

[*] 1-1.참고 : /etc/pam.d/system-auth 진단
[*] 1-2.예시: password requisite pam_cracklib.so try_first_pass retry=3 type= minlen=8 dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1
[*] 2-1.참고 : /etc/pam.d/common-password 진단
[*] 2-2.패스워드 길이 확인 : password [success=2 default=ignore] pam_unix.so obscure sha512 minlen=8
2-3.패스워드 복잡도 확인 : password requisite pam_pwquality.so retry=3 lcredit=-1 ucredit=-1 dcredit=-1 ocredit=-1
[*] 3-1.참고 : /etc/security/pwquality.conf 진단
[*] 3-2.예시 : lcredit, ucredit, dcredit, ocredit 값 확인
 * 양호 기준 : 패스워드 최소길이 8자리 이상, 영문·숫자·특수문자 최소 입력 기능이 설정된 경우 또는 내부 정책에 맞게 설정된 경우
 * 취약 기준 : 패스워드 최소길이 8자리 이상, 영문·숫자·특수문자 최소 입력 기능이 설정된 경우
=============================================




[U-03] 계정 잠금 임계값 설정
[U-03_START]
=============================================
[+] 1. 현황 : /etc/pam.d/password-auth
# Generated by authselect on Tue Jun 17 14:31:50 2025
# Do not modify this file manually.

auth        required                                     pam_env.so
auth        required                                     pam_faildelay.so delay=2000000
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
auth        sufficient                                   pam_unix.so nullok
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        sufficient                                   pam_sss.so forward_pass
auth        required                                     pam_deny.so
auth        required                                     pam_faillock.so preauth audit deny=10 unlock_time=60
auth        [default=die]                                pam_faillock.so authfail audit deny=10 unlock_time=60
auth        include                                      system-auth

account     required                                     pam_unix.so
account     sufficient                                   pam_localuser.so
account     sufficient                                   pam_usertype.so issystem
account     [default=bad success=ok user_unknown=ignore] pam_sss.so
account     required                                     pam_permit.so
account     required                                     pam_faillock.so

password    requisite                                    pam_pwquality.so local_users_only
password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
password    [success=1 default=ignore]                   pam_localuser.so
password    sufficient                                   pam_sss.so use_authtok
password    required                                     pam_deny.so

session     optional                                     pam_keyinit.so revoke
session     required                                     pam_limits.so
-session    optional                                     pam_systemd.so
session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
session     required                                     pam_unix.so
session     optional                                     pam_sss.so

[+] 2. 현황 : /etc/pam.d/common-auth
파일이 존재하지 않습니다.

[+] 3. 현황 : /etc/pam.d/system-auth
# Generated by authselect on Tue Jun 17 14:31:50 2025
# Do not modify this file manually.

auth        required                                     pam_env.so
auth        required                                     pam_faildelay.so delay=2000000
auth        sufficient                                   pam_fprintd.so
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
auth        sufficient                                   pam_unix.so nullok
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        sufficient                                   pam_sss.so forward_pass
auth        required                                     pam_deny.so
auth        required                                     pam_faillock.so preauth audit deny=3 unlock_time=600
auth        [default=die]                                pam_faillock.so authfail audit deny=3 unlock_time=600

account     required                                     pam_unix.so
account     sufficient                                   pam_localuser.so
account     sufficient                                   pam_usertype.so issystem
account     [default=bad success=ok user_unknown=ignore] pam_sss.so
account     required                                     pam_permit.so
account     required                                     pam_faillock.so

password    requisite                                    pam_pwquality.so local_users_only
password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
password    [success=1 default=ignore]                   pam_localuser.so
password    sufficient                                   pam_sss.so use_authtok
password    required                                     pam_deny.so

session     optional                                     pam_keyinit.so revoke
session     required                                     pam_limits.so
-session    optional                                     pam_systemd.so
session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
session     required                                     pam_unix.so
session     optional                                     pam_sss.so


[+] 4. 8/9 버전 인경우 : /etc/security/faillock.conf 
# Deny access if the number of consecutive authentication failures
# deny = 3
# even_deny_root
# This option implies the `even_deny_root` option.
# the root account (the options `even_deny_root>` and


=============================================
[U-03_END]
[참고 - 진단기준, 결과 값 출력]
[*] 판단기준(양호) : /etc/pam.d/password-auth 파일과 /etc/pam.d/system-auth 파일에 계정 잠금 임계값 설정이 존재하는 경우
[*] 판단기준(취약) : /etc/pam.d/password-auth 파일과 /etc/pam.d/system-auth 파일에 계정 잠금 임계값 설정이 존재하지 않는 경우

=== 판단 기준 참고 ===
(1) pam_faillock.so 활용 시
auth     required       pam_faillock.so preauth silent audit deny=3 unlock_time=600
auth     [success=1 default=ignore]     pam_unix.so nullok_secure
auth     [default=die]  pam_faillock.so authfail audit deny=3 unlock_time=600
account  required       pam_faillock.so

(2) pam_tally2.so 활용 시
auth        required      pam_tally2.so deny=5 onerr=fail unlock_time=600
account     required      pam_tally2.so

(3) pam_tally.so 활용 시
auth        required      pam_tally.so deny=5 onerr=fail unlock_time=600
account     required      pam_tally.so

(4) RHEL 8 경우
/etc/security/faillock.conf 우선 적용
deny = 5
unlock_time = 600

=================
=============================================




[U-04] 패스워드 파일 보호
[U-04_START]
=============================================
[+] 현황
[+] 1. 현황 : ls -al /etc/passwd /etc/shadow
-rw-r--r--. 1 root root 1947 Jun 30 14:25 /etc/passwd
----------. 1 root root 1275 Jun 30 14:25 /etc/shadow

[+] 2. 현황 : /etc/passwd 상세 내용
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:65534:65534:Kernel Overflow User:/:/sbin/nologin
unbound:x:999:999:Unbound DNS resolver:/etc/unbound:/sbin/nologin
systemd-coredump:x:998:996:systemd Core Dumper:/:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
polkitd:x:997:995:User for polkitd:/:/sbin/nologin
libstoragemgmt:x:996:992:daemon account for libstoragemgmt:/var/run/lsm:/sbin/nologin
tss:x:59:59:Account used for TPM access:/dev/null:/sbin/nologin
cockpit-ws:x:995:991:User for cockpit web service:/nonexisting:/sbin/nologin
sssd:x:993:989:User for sssd:/:/sbin/nologin
setroubleshoot:x:992:988::/var/lib/setroubleshoot:/sbin/nologin
clevis:x:991:987:Clevis Decryption Framework unprivileged user:/var/cache/clevis:/usr/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/usr/share/empty.sshd:/sbin/nologin
chrony:x:990:986::/var/lib/chrony:/sbin/nologin
tcpdump:x:72:72::/:/sbin/nologin
systemd-oom:x:984:984:systemd Userspace OOM Killer:/:/usr/sbin/nologin
systemd-resolve:x:983:983:systemd Resolver:/:/usr/sbin/nologin
jian:x:1000:1000::/home/jian:/bin/bash
apache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin
saslauth:x:982:76:Saslauthd user:/run/saslauthd:/sbin/nologin
mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin
smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin
named:x:25:25:Named:/var/named:/sbin/nologin
lynsecure:x:1001:1001::/home/lynsecure:/bin/bash
rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin

[+] 3. 현황 : /etc/shadow 상세 내용
root:$6$rounds=100000$gMz/PrfLoIA2iBpE$NTW48uWereB9FhEnUcGBqgJG66a6MUa58lB3nLHPXHB0akq1RCUypy4B/oc9cpLwxltMYM9.d.VWT4LSLTurC.:20262:0:99999:7:::
bin:*:18849:0:99999:7:::
daemon:*:18849:0:99999:7:::
adm:*:18849:0:99999:7:::
lp:*:18849:0:99999:7:::
sync:*:18849:0:99999:7:::
shutdown:*:18849:0:99999:7:::
halt:*:18849:0:99999:7:::
mail:*:18849:0:99999:7:::
operator:*:18849:0:99999:7:::
games:*:18849:0:99999:7:::
ftp:*:18849:0:99999:7:::
nobody:*:18849:0:99999:7:::
unbound:!!:19011::::::
systemd-coredump:!!:19011::::::
dbus:!!:19011::::::
polkitd:!!:19011::::::
libstoragemgmt:!!:19011::::::
tss:!!:19011::::::
cockpit-ws:!!:19011::::::
sssd:!!:19011::::::
setroubleshoot:!!:19011::::::
clevis:!!:19011::::::
sshd:!!:19011::::::
chrony:!!:19011::::::
tcpdump:!!:19011::::::
systemd-oom:!*:19011::::::
systemd-resolve:!*:19011::::::
jian:$6$IoT9aJOgoXxvIEEf$cdaXFxc07kscsE/RqZGyl3GtZMByQi31jNAzb4GOnv4c9YkTKxvHzFqo40HAO26QDzyulsLDI0MRgWqG6tvpp.:20251:0:99999:7:::
apache:!!:20251::::::
saslauth:!!:20255::::::
mailnull:!!:20255::::::
smmsp:!!:20255::::::
named:!!:20255::::::
lynsecure:$6$rounds=100000$io7sVJPTS7x5mVSe$PGSbtQaNkI0JfkDWeYakVHsAZcTleQ7x5BIsZcmfDhHZof9mv15r/l1pN61jIwt90YmNVee6w4BpCmYeN3BdN1:20263:0:99999:7:::
rpc:!!:20258:0:99999:7:::
rpcuser:!!:20258::::::

[U-04_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
[*] 두번째 필드가 x 표시되어 있는지 확인
 * 양호 - shadow 패스워드를 사용하거나, 패스워드를 암호화하여 저장하는 경우
 * 취약 - shadow 패스워드를 사용하지 않고, 패스워드를 암호화하여 저장하지 앟는 경우
=============================================




[U-44] root 이외의 UID가 ‘0’금지
[U-44_START]
=============================================
[+] 1. 현황 : /etc/passwd에서 UID 추출
root = 0
bin = 1
daemon = 2
adm = 3
lp = 4
sync = 5
shutdown = 6
halt = 7
mail = 8
operator = 11
games = 12
ftp = 14
nobody = 65534
unbound = 999
systemd-coredump = 998
dbus = 81
polkitd = 997
libstoragemgmt = 996
tss = 59
cockpit-ws = 995
sssd = 993
setroubleshoot = 992
clevis = 991
sshd = 74
chrony = 990
tcpdump = 72
systemd-oom = 984
systemd-resolve = 983
jian = 1000
apache = 48
saslauth = 982
mailnull = 47
smmsp = 51
named = 25
lynsecure = 1001
rpc = 32
rpcuser = 29

[+] 2. 국정원 점검용 GID 최소한의 사용자만 등록되어 있는지 확인 (GID가 0인 계정 추출)
root -> GID=0
sync -> GID=0
shutdown -> GID=0
halt -> GID=0
operator -> GID=0


=============================================
[U-44_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : root 계정과 동일한 UID를 갖는 계정이 존재하지 않는 경우
 * 취약 조건 : root 계정과 동일한 UID를 갖는 계정이 존재하는 경우
=============================================




[U-45] root 계정 su 제한
[U-45_START]
=============================================
[+] 1. 현황 : /etc/pam.d/su 설정 확인
#%PAM-1.0
auth		required	pam_env.so
auth		sufficient	pam_rootok.so
# Uncomment the following line to implicitly trust users in the "wheel" group.
#auth		sufficient	pam_wheel.so trust use_uid
# Uncomment the following line to require a user to be in the "wheel" group.
#auth		required	pam_wheel.so use_uid
auth		substack	system-auth
auth		include		postlogin
account		sufficient	pam_succeed_if.so uid = 0 use_uid quiet
account		include		system-auth
password	include		system-auth
session		include		system-auth
session		include		postlogin
session		optional	pam_xauth.so

[+] 2. 현황 : /bin/su의 others 여부
[+] /bin/su의 others 확인
-rwsr-xr-x. 1 root root 57112 Jan 17 01:59 /bin/su

[+] 3. 현황 : group 확인
root:x:0:
bin:x:1:
daemon:x:2:
sys:x:3:
adm:x:4:
tty:x:5:
disk:x:6:
lp:x:7:
mem:x:8:
kmem:x:9:
wheel:x:10:jian
cdrom:x:11:
mail:x:12:
man:x:15:
dialout:x:18:
floppy:x:19:
games:x:20:
tape:x:33:
video:x:39:
ftp:x:50:
lock:x:54:
audio:x:63:
users:x:100:
nobody:x:65534:
utmp:x:22:
utempter:x:35:
unbound:x:999:
input:x:998:
kvm:x:36:
render:x:997:
systemd-journal:x:190:
systemd-coredump:x:996:
dbus:x:81:
polkitd:x:995:
printadmin:x:994:
ssh_keys:x:993:
libstoragemgmt:x:992:
tss:x:59:clevis
cockpit-ws:x:991:
sssd:x:989:
setroubleshoot:x:988:
clevis:x:987:
sshd:x:74:
chrony:x:986:
slocate:x:21:
tcpdump:x:72:
sgx:x:985:
systemd-oom:x:984:
systemd-resolve:x:983:
jian:x:1000:
apache:x:48:
saslauth:x:76:
mailnull:x:47:
smmsp:x:51:
named:x:25:
lynsecure:x:1001:
rpc:x:32:
rpcuser:x:29:
=============================================
[U-45_END]
[참고 - 진단기준, 결과 값 출력]
[*] 판단기준(양호) : /etc/pam.d/su 파일에 auth required pam_wheel.so use_uid 라인이 존재하는 경우
[*] 판단기준(취약) : /etc/pam.d/su 파일에 auth required pam_wheel.so use_uid 라인이 존재하지 않거나 주석 처리 되어 있는 경우

=============================================




[U-46] 패스워드 최소 길이 설정
[U-46_START]
=============================================
[+] 1. /etc/pam.d/system-auth 현황
# Generated by authselect on Tue Jun 17 14:31:50 2025
# Do not modify this file manually.

auth        required                                     pam_env.so
auth        required                                     pam_faildelay.so delay=2000000
auth        sufficient                                   pam_fprintd.so
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
auth        sufficient                                   pam_unix.so nullok
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        sufficient                                   pam_sss.so forward_pass
auth        required                                     pam_deny.so
auth        required                                     pam_faillock.so preauth audit deny=3 unlock_time=600
auth        [default=die]                                pam_faillock.so authfail audit deny=3 unlock_time=600

account     required                                     pam_unix.so
account     sufficient                                   pam_localuser.so
account     sufficient                                   pam_usertype.so issystem
account     [default=bad success=ok user_unknown=ignore] pam_sss.so
account     required                                     pam_permit.so
account     required                                     pam_faillock.so

password    requisite                                    pam_pwquality.so local_users_only
password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
password    [success=1 default=ignore]                   pam_localuser.so
password    sufficient                                   pam_sss.so use_authtok
password    required                                     pam_deny.so

session     optional                                     pam_keyinit.so revoke
session     required                                     pam_limits.so
-session    optional                                     pam_systemd.so
session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
session     required                                     pam_unix.so
session     optional                                     pam_sss.so

[+] 2. /etc/pam.d/common-password 현황
cat: /etc/pam.d/common-password: No such file or directory

[+] 3. 현황 : /etc/security/pwquality.conf 상세 내용
# Configuration for systemwide password quality limits
# Defaults:
#
# Number of characters in the new password that must not be present in the
# old password.
# difok = 1
#
# Minimum acceptable size for the new password (plus one if
# credits are not disabled which is the default). (See pam_cracklib manual.)
# Cannot be set to lower value than 6.
minlen = 10 
#
# The maximum credit for having digits in the new password. If less than 0
# it is the minimum number of digits in the new password.
# dcredit = 0
#
# The maximum credit for having uppercase characters in the new password.
# If less than 0 it is the minimum number of uppercase characters in the new
# password.
# ucredit = 0
#
# The maximum credit for having lowercase characters in the new password.
# If less than 0 it is the minimum number of lowercase characters in the new
# password.
# lcredit = 0
#
# The maximum credit for having other characters in the new password.
# If less than 0 it is the minimum number of other characters in the new
# password.
# ocredit = 0
#
# The minimum number of required classes of characters for the new
# password (digits, uppercase, lowercase, others).
minclass = 2 
#
# The maximum number of allowed consecutive same characters in the new password.
# The check is disabled if the value is 0.
# maxrepeat = 0
#
# The maximum number of allowed consecutive characters of the same class in the
# new password.
# The check is disabled if the value is 0.
# maxclassrepeat = 0
#
# Whether to check for the words from the passwd entry GECOS string of the user.
# The check is enabled if the value is not 0.
# gecoscheck = 0
#
# Whether to check for the words from the cracklib dictionary.
# The check is enabled if the value is not 0.
# dictcheck = 1
#
# Whether to check if it contains the user name in some form.
# The check is enabled if the value is not 0.
# usercheck = 1
#
# Length of substrings from the username to check for in the password
# The check is enabled if the value is greater than 0 and usercheck is enabled.
# usersubstr = 0
#
# Whether the check is enforced by the PAM module and possibly other
# applications.
# The new password is rejected if it fails the check and the value is not 0.
# enforcing = 1
#
# Path to the cracklib dictionaries. Default is to use the cracklib default.
# dictpath =
#
# Prompt user at most N times before returning with error. The default is 1.
# retry = 3
#
# Enforces pwquality checks on the root user password.
# Enabled if the option is present.
# enforce_for_root
#
# Skip testing the password quality for users that are not present in the
# /etc/passwd file.
# Enabled if the option is present.
# local_users_only

[+] 4. 현황 : /etc/login.defs 상세 내용
#
# Please note that the parameters in this configuration file control the
# behavior of the tools from the shadow-utils component. None of these
# tools uses the PAM mechanism, and the utilities that use PAM (such as the
# passwd command) should therefore be configured elsewhere. Refer to
# /etc/pam.d/system-auth for more information.
#

#
# Delay in seconds before being allowed another attempt after a login failure
# Note: When PAM is used, some modules may enforce a minimum delay (e.g.
#       pam_unix(8) enforces a 2s delay)
#
#FAIL_DELAY		3

# Currently FAILLOG_ENAB is not supported

#
# Enable display of unknown usernames when login(1) failures are recorded.
#
#LOG_UNKFAIL_ENAB	no

# Currently LOG_OK_LOGINS is not supported

# Currently LASTLOG_ENAB is not supported

#
# Limit the highest user ID number for which the lastlog entries should
# be updated.
#
# No LASTLOG_UID_MAX means that there is no user ID limit for writing
# lastlog entries.
#
#LASTLOG_UID_MAX

# Currently MAIL_CHECK_ENAB is not supported

# Currently OBSCURE_CHECKS_ENAB is not supported

# Currently PORTTIME_CHECKS_ENAB is not supported

# Currently QUOTAS_ENAB is not supported

# Currently SYSLOG_SU_ENAB is not supported

#
# Enable "syslog" logging of newgrp(1) and sg(1) activity.
#
#SYSLOG_SG_ENAB		yes

# Currently CONSOLE is not supported

# Currently SULOG_FILE is not supported

# Currently MOTD_FILE is not supported

# Currently ISSUE_FILE is not supported

# Currently TTYTYPE_FILE is not supported

# Currently FTMP_FILE is not supported

# Currently NOLOGINS_FILE is not supported

# Currently SU_NAME is not supported

# *REQUIRED*
#   Directory where mailboxes reside, _or_ name of file, relative to the
#   home directory.  If you _do_ define both, MAIL_DIR takes precedence.
#
MAIL_DIR	/var/spool/mail
#MAIL_FILE	.mail

#
# If defined, file which inhibits all the usual chatter during the login
# sequence.  If a full pathname, then hushed mode will be enabled if the
# user's name or shell are found in the file.  If not a full pathname, then
# hushed mode will be enabled if the file exists in the user's home directory.
#
#HUSHLOGIN_FILE	.hushlogin
#HUSHLOGIN_FILE	/etc/hushlogins

# Currently ENV_TZ is not supported

# Currently ENV_HZ is not supported

#
# The default PATH settings, for superuser and normal users.
#
# (they are minimal, add the rest in the shell startup files)
#ENV_SUPATH	PATH=/sbin:/bin:/usr/sbin:/usr/bin
#ENV_PATH	PATH=/bin:/usr/bin

#
# Terminal permissions
#
#	TTYGROUP	Login tty will be assigned this group ownership.
#	TTYPERM		Login tty will be set to this permission.
#
# If you have a write(1) program which is "setgid" to a special group
# which owns the terminals, define TTYGROUP as the number of such group
# and TTYPERM as 0620.  Otherwise leave TTYGROUP commented out and
# set TTYPERM to either 622 or 600.
#
#TTYGROUP	tty
#TTYPERM		0600

# Currently ERASECHAR, KILLCHAR and ULIMIT are not supported

# Default initial "umask" value used by login(1) on non-PAM enabled systems.
# Default "umask" value for pam_umask(8) on PAM enabled systems.
# UMASK is also used by useradd(8) and newusers(8) to set the mode for new
# home directories if HOME_MODE is not set.
# 022 is the default value, but 027, or even 077, could be considered
# for increased privacy. There is no One True Answer here: each sysadmin
# must make up their mind.
UMASK		022

# HOME_MODE is used by useradd(8) and newusers(8) to set the mode for new
# home directories.
# If HOME_MODE is not set, the value of UMASK is used to create the mode.
HOME_MODE	0700

# Password aging controls:
#
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
#	PASS_MIN_LEN	Minimum acceptable password length.
#	PASS_WARN_AGE	Number of days warning given before a password expires.
#
PASS_MAX_DAYS	90
PASS_MIN_DAYS	1
PASS_WARN_AGE	7

# Currently PASS_MIN_LEN is not supported

# Currently SU_WHEEL_ONLY is not supported

# Currently CRACKLIB_DICTPATH is not supported

#
# Min/max values for automatic uid selection in useradd(8)
#
UID_MIN                  1000
UID_MAX                 60000
# System accounts
SYS_UID_MIN               201
SYS_UID_MAX               999
# Extra per user uids
SUB_UID_MIN		   100000
SUB_UID_MAX		600100000
SUB_UID_COUNT		    65536

#
# Min/max values for automatic gid selection in groupadd(8)
#
GID_MIN                  1000
GID_MAX                 60000
# System accounts
SYS_GID_MIN               201
SYS_GID_MAX               999
# Extra per user group ids
SUB_GID_MIN		   100000
SUB_GID_MAX		600100000
SUB_GID_COUNT		    65536

#
# Max number of login(1) retries if password is bad
#
#LOGIN_RETRIES		3

#
# Max time in seconds for login(1)
#
#LOGIN_TIMEOUT		60

# Currently PASS_CHANGE_TRIES is not supported

# Currently PASS_ALWAYS_WARN is not supported

# Currently PASS_MAX_LEN is not supported

# Currently CHFN_AUTH is not supported

#
# Which fields may be changed by regular users using chfn(1) - use
# any combination of letters "frwh" (full name, room number, work
# phone, home phone).  If not defined, no changes are allowed.
# For backward compatibility, "yes" = "rwh" and "no" = "frwh".
# 
#CHFN_RESTRICT		rwh

# Currently LOGIN_STRING is not supported

# Currently MD5_CRYPT_ENAB is not supported

#
# If set to MD5, MD5-based algorithm will be used for encrypting password
# If set to SHA256, SHA256-based algorithm will be used for encrypting password
# If set to SHA512, SHA512-based algorithm will be used for encrypting password
# If set to BLOWFISH, BLOWFISH-based algorithm will be used for encrypting password
# If set to DES, DES-based algorithm will be used for encrypting password (default)
#
ENCRYPT_METHOD SHA512

#
# Only works if ENCRYPT_METHOD is set to SHA256 or SHA512.
#
# Define the number of SHA rounds.
# With a lot of rounds, it is more difficult to brute-force the password.
# However, more CPU resources will be needed to authenticate users if
# this value is increased.
#
# If not specified, the libc will choose the default number of rounds (5000).
# The values must be within the 1000-999999999 range.
#
SHA_CRYPT_MAX_ROUNDS 100000

# Currently SHA_CRYPT_MIN_ROUNDS is not supported

# Currently BCRYPT_MIN_ROUNDS and BCRYPT_MAX_ROUNDS are not supported

# Currently CONSOLE_GROUPS is not supported

#
# Should login be allowed if we can't cd to the home directory?
# Default is yes.
#
#DEFAULT_HOME	yes

# Currently ENVIRON_FILE is not supported

#
# If defined, this command is run when removing a user.
# It should remove any at/cron/print jobs etc. owned by
# the user to be removed (passed as the first argument).
#
#USERDEL_CMD	/usr/sbin/userdel_local

#
# Enables userdel(8) to remove user groups if no members exist.
#
USERGROUPS_ENAB yes

#
# If set to a non-zero number, the shadow utilities will make sure that
# groups never have more than this number of users on one line.
# This permits to support split groups (groups split into multiple lines,
# with the same group ID, to avoid limitation of the line length in the
# group file).
#
# 0 is the default value and disables this feature.
#
#MAX_MEMBERS_PER_GROUP	0

#
# If useradd(8) should create home directories for users by default (non
# system users only).
# This option is overridden with the -M or -m flags on the useradd(8)
# command-line.
#
CREATE_HOME	yes

#
# Force use shadow, even if shadow passwd & shadow group files are
# missing.
#
#FORCE_SHADOW    yes

#
# Select the HMAC cryptography algorithm.
# Used in pam_timestamp module to calculate the keyed-hash message
# authentication code.
#
# Note: It is recommended to check hmac(3) to see the possible algorithms
# that are available in your system.
#
HMAC_CRYPTO_ALGO SHA512

[+] 4-1. 현황 : PASS_MIN_LEN 내용
#	PASS_MIN_LEN	Minimum acceptable password length.
# Currently PASS_MIN_LEN is not supported



[U-46_END]
=============================================
[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : 패스워드 최소 길이가 8자 이상으로 설정되어 있는 경우
 * 취약 기준 : 패스워드 최소 길이가 8자 미만으로 설정되어 있는 경우 
=============================================




[U-47] 패스워드 최대 사용기간 설정
[U-47_START]
=============================================
[+] 1. /etc/pam.d/system-auth 현황
# Generated by authselect on Tue Jun 17 14:31:50 2025
# Do not modify this file manually.

auth        required                                     pam_env.so
auth        required                                     pam_faildelay.so delay=2000000
auth        sufficient                                   pam_fprintd.so
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
auth        sufficient                                   pam_unix.so nullok
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        sufficient                                   pam_sss.so forward_pass
auth        required                                     pam_deny.so
auth        required                                     pam_faillock.so preauth audit deny=3 unlock_time=600
auth        [default=die]                                pam_faillock.so authfail audit deny=3 unlock_time=600

account     required                                     pam_unix.so
account     sufficient                                   pam_localuser.so
account     sufficient                                   pam_usertype.so issystem
account     [default=bad success=ok user_unknown=ignore] pam_sss.so
account     required                                     pam_permit.so
account     required                                     pam_faillock.so

password    requisite                                    pam_pwquality.so local_users_only
password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
password    [success=1 default=ignore]                   pam_localuser.so
password    sufficient                                   pam_sss.so use_authtok
password    required                                     pam_deny.so

session     optional                                     pam_keyinit.so revoke
session     required                                     pam_limits.so
-session    optional                                     pam_systemd.so
session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
session     required                                     pam_unix.so
session     optional                                     pam_sss.so

[+] 2. /etc/pam.d/common-password 현황
파일이 존재하지 않습니다.

[+] 3. 현황 : /etc/security/pwquality.conf 상세 내용
# Configuration for systemwide password quality limits
# Defaults:
#
# Number of characters in the new password that must not be present in the
# old password.
# difok = 1
#
# Minimum acceptable size for the new password (plus one if
# credits are not disabled which is the default). (See pam_cracklib manual.)
# Cannot be set to lower value than 6.
minlen = 10 
#
# The maximum credit for having digits in the new password. If less than 0
# it is the minimum number of digits in the new password.
# dcredit = 0
#
# The maximum credit for having uppercase characters in the new password.
# If less than 0 it is the minimum number of uppercase characters in the new
# password.
# ucredit = 0
#
# The maximum credit for having lowercase characters in the new password.
# If less than 0 it is the minimum number of lowercase characters in the new
# password.
# lcredit = 0
#
# The maximum credit for having other characters in the new password.
# If less than 0 it is the minimum number of other characters in the new
# password.
# ocredit = 0
#
# The minimum number of required classes of characters for the new
# password (digits, uppercase, lowercase, others).
minclass = 2 
#
# The maximum number of allowed consecutive same characters in the new password.
# The check is disabled if the value is 0.
# maxrepeat = 0
#
# The maximum number of allowed consecutive characters of the same class in the
# new password.
# The check is disabled if the value is 0.
# maxclassrepeat = 0
#
# Whether to check for the words from the passwd entry GECOS string of the user.
# The check is enabled if the value is not 0.
# gecoscheck = 0
#
# Whether to check for the words from the cracklib dictionary.
# The check is enabled if the value is not 0.
# dictcheck = 1
#
# Whether to check if it contains the user name in some form.
# The check is enabled if the value is not 0.
# usercheck = 1
#
# Length of substrings from the username to check for in the password
# The check is enabled if the value is greater than 0 and usercheck is enabled.
# usersubstr = 0
#
# Whether the check is enforced by the PAM module and possibly other
# applications.
# The new password is rejected if it fails the check and the value is not 0.
# enforcing = 1
#
# Path to the cracklib dictionaries. Default is to use the cracklib default.
# dictpath =
#
# Prompt user at most N times before returning with error. The default is 1.
# retry = 3
#
# Enforces pwquality checks on the root user password.
# Enabled if the option is present.
# enforce_for_root
#
# Skip testing the password quality for users that are not present in the
# /etc/passwd file.
# Enabled if the option is present.
# local_users_only

[+] 4. 현황 : /etc/login.defs 상세 내용
#
# Please note that the parameters in this configuration file control the
# behavior of the tools from the shadow-utils component. None of these
# tools uses the PAM mechanism, and the utilities that use PAM (such as the
# passwd command) should therefore be configured elsewhere. Refer to
# /etc/pam.d/system-auth for more information.
#

#
# Delay in seconds before being allowed another attempt after a login failure
# Note: When PAM is used, some modules may enforce a minimum delay (e.g.
#       pam_unix(8) enforces a 2s delay)
#
#FAIL_DELAY		3

# Currently FAILLOG_ENAB is not supported

#
# Enable display of unknown usernames when login(1) failures are recorded.
#
#LOG_UNKFAIL_ENAB	no

# Currently LOG_OK_LOGINS is not supported

# Currently LASTLOG_ENAB is not supported

#
# Limit the highest user ID number for which the lastlog entries should
# be updated.
#
# No LASTLOG_UID_MAX means that there is no user ID limit for writing
# lastlog entries.
#
#LASTLOG_UID_MAX

# Currently MAIL_CHECK_ENAB is not supported

# Currently OBSCURE_CHECKS_ENAB is not supported

# Currently PORTTIME_CHECKS_ENAB is not supported

# Currently QUOTAS_ENAB is not supported

# Currently SYSLOG_SU_ENAB is not supported

#
# Enable "syslog" logging of newgrp(1) and sg(1) activity.
#
#SYSLOG_SG_ENAB		yes

# Currently CONSOLE is not supported

# Currently SULOG_FILE is not supported

# Currently MOTD_FILE is not supported

# Currently ISSUE_FILE is not supported

# Currently TTYTYPE_FILE is not supported

# Currently FTMP_FILE is not supported

# Currently NOLOGINS_FILE is not supported

# Currently SU_NAME is not supported

# *REQUIRED*
#   Directory where mailboxes reside, _or_ name of file, relative to the
#   home directory.  If you _do_ define both, MAIL_DIR takes precedence.
#
MAIL_DIR	/var/spool/mail
#MAIL_FILE	.mail

#
# If defined, file which inhibits all the usual chatter during the login
# sequence.  If a full pathname, then hushed mode will be enabled if the
# user's name or shell are found in the file.  If not a full pathname, then
# hushed mode will be enabled if the file exists in the user's home directory.
#
#HUSHLOGIN_FILE	.hushlogin
#HUSHLOGIN_FILE	/etc/hushlogins

# Currently ENV_TZ is not supported

# Currently ENV_HZ is not supported

#
# The default PATH settings, for superuser and normal users.
#
# (they are minimal, add the rest in the shell startup files)
#ENV_SUPATH	PATH=/sbin:/bin:/usr/sbin:/usr/bin
#ENV_PATH	PATH=/bin:/usr/bin

#
# Terminal permissions
#
#	TTYGROUP	Login tty will be assigned this group ownership.
#	TTYPERM		Login tty will be set to this permission.
#
# If you have a write(1) program which is "setgid" to a special group
# which owns the terminals, define TTYGROUP as the number of such group
# and TTYPERM as 0620.  Otherwise leave TTYGROUP commented out and
# set TTYPERM to either 622 or 600.
#
#TTYGROUP	tty
#TTYPERM		0600

# Currently ERASECHAR, KILLCHAR and ULIMIT are not supported

# Default initial "umask" value used by login(1) on non-PAM enabled systems.
# Default "umask" value for pam_umask(8) on PAM enabled systems.
# UMASK is also used by useradd(8) and newusers(8) to set the mode for new
# home directories if HOME_MODE is not set.
# 022 is the default value, but 027, or even 077, could be considered
# for increased privacy. There is no One True Answer here: each sysadmin
# must make up their mind.
UMASK		022

# HOME_MODE is used by useradd(8) and newusers(8) to set the mode for new
# home directories.
# If HOME_MODE is not set, the value of UMASK is used to create the mode.
HOME_MODE	0700

# Password aging controls:
#
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
#	PASS_MIN_LEN	Minimum acceptable password length.
#	PASS_WARN_AGE	Number of days warning given before a password expires.
#
PASS_MAX_DAYS	90
PASS_MIN_DAYS	1
PASS_WARN_AGE	7

# Currently PASS_MIN_LEN is not supported

# Currently SU_WHEEL_ONLY is not supported

# Currently CRACKLIB_DICTPATH is not supported

#
# Min/max values for automatic uid selection in useradd(8)
#
UID_MIN                  1000
UID_MAX                 60000
# System accounts
SYS_UID_MIN               201
SYS_UID_MAX               999
# Extra per user uids
SUB_UID_MIN		   100000
SUB_UID_MAX		600100000
SUB_UID_COUNT		    65536

#
# Min/max values for automatic gid selection in groupadd(8)
#
GID_MIN                  1000
GID_MAX                 60000
# System accounts
SYS_GID_MIN               201
SYS_GID_MAX               999
# Extra per user group ids
SUB_GID_MIN		   100000
SUB_GID_MAX		600100000
SUB_GID_COUNT		    65536

#
# Max number of login(1) retries if password is bad
#
#LOGIN_RETRIES		3

#
# Max time in seconds for login(1)
#
#LOGIN_TIMEOUT		60

# Currently PASS_CHANGE_TRIES is not supported

# Currently PASS_ALWAYS_WARN is not supported

# Currently PASS_MAX_LEN is not supported

# Currently CHFN_AUTH is not supported

#
# Which fields may be changed by regular users using chfn(1) - use
# any combination of letters "frwh" (full name, room number, work
# phone, home phone).  If not defined, no changes are allowed.
# For backward compatibility, "yes" = "rwh" and "no" = "frwh".
# 
#CHFN_RESTRICT		rwh

# Currently LOGIN_STRING is not supported

# Currently MD5_CRYPT_ENAB is not supported

#
# If set to MD5, MD5-based algorithm will be used for encrypting password
# If set to SHA256, SHA256-based algorithm will be used for encrypting password
# If set to SHA512, SHA512-based algorithm will be used for encrypting password
# If set to BLOWFISH, BLOWFISH-based algorithm will be used for encrypting password
# If set to DES, DES-based algorithm will be used for encrypting password (default)
#
ENCRYPT_METHOD SHA512

#
# Only works if ENCRYPT_METHOD is set to SHA256 or SHA512.
#
# Define the number of SHA rounds.
# With a lot of rounds, it is more difficult to brute-force the password.
# However, more CPU resources will be needed to authenticate users if
# this value is increased.
#
# If not specified, the libc will choose the default number of rounds (5000).
# The values must be within the 1000-999999999 range.
#
SHA_CRYPT_MAX_ROUNDS 100000

# Currently SHA_CRYPT_MIN_ROUNDS is not supported

# Currently BCRYPT_MIN_ROUNDS and BCRYPT_MAX_ROUNDS are not supported

# Currently CONSOLE_GROUPS is not supported

#
# Should login be allowed if we can't cd to the home directory?
# Default is yes.
#
#DEFAULT_HOME	yes

# Currently ENVIRON_FILE is not supported

#
# If defined, this command is run when removing a user.
# It should remove any at/cron/print jobs etc. owned by
# the user to be removed (passed as the first argument).
#
#USERDEL_CMD	/usr/sbin/userdel_local

#
# Enables userdel(8) to remove user groups if no members exist.
#
USERGROUPS_ENAB yes

#
# If set to a non-zero number, the shadow utilities will make sure that
# groups never have more than this number of users on one line.
# This permits to support split groups (groups split into multiple lines,
# with the same group ID, to avoid limitation of the line length in the
# group file).
#
# 0 is the default value and disables this feature.
#
#MAX_MEMBERS_PER_GROUP	0

#
# If useradd(8) should create home directories for users by default (non
# system users only).
# This option is overridden with the -M or -m flags on the useradd(8)
# command-line.
#
CREATE_HOME	yes

#
# Force use shadow, even if shadow passwd & shadow group files are
# missing.
#
#FORCE_SHADOW    yes

#
# Select the HMAC cryptography algorithm.
# Used in pam_timestamp module to calculate the keyed-hash message
# authentication code.
#
# Note: It is recommended to check hmac(3) to see the possible algorithms
# that are available in your system.
#
HMAC_CRYPTO_ALGO SHA512

[+] 4-1. 현황 : PASS_MAX_DAYS 내용
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
PASS_MAX_DAYS	90



[U-47_END]
=============================================
[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : 패스워드 최대 사용기간이 90일(12주) 이하로 설정되어 있는 경우
 * 취약 기준 : 패스워드 최대 사용기간이 90일(12주) 이하로 설정되어 있지 않는 경우
=============================================




[U-48] 패스워드 최소 사용기간 설정
[U-48_START]
=============================================
[+] 1. /etc/pam.d/system-auth 현황
# Generated by authselect on Tue Jun 17 14:31:50 2025
# Do not modify this file manually.

auth        required                                     pam_env.so
auth        required                                     pam_faildelay.so delay=2000000
auth        sufficient                                   pam_fprintd.so
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        [default=1 ignore=ignore success=ok]         pam_localuser.so
auth        sufficient                                   pam_unix.so nullok
auth        [default=1 ignore=ignore success=ok]         pam_usertype.so isregular
auth        sufficient                                   pam_sss.so forward_pass
auth        required                                     pam_deny.so
auth        required                                     pam_faillock.so preauth audit deny=3 unlock_time=600
auth        [default=die]                                pam_faillock.so authfail audit deny=3 unlock_time=600

account     required                                     pam_unix.so
account     sufficient                                   pam_localuser.so
account     sufficient                                   pam_usertype.so issystem
account     [default=bad success=ok user_unknown=ignore] pam_sss.so
account     required                                     pam_permit.so
account     required                                     pam_faillock.so

password    requisite                                    pam_pwquality.so local_users_only
password    sufficient                                   pam_unix.so sha512 shadow nullok use_authtok
password    [success=1 default=ignore]                   pam_localuser.so
password    sufficient                                   pam_sss.so use_authtok
password    required                                     pam_deny.so

session     optional                                     pam_keyinit.so revoke
session     required                                     pam_limits.so
-session    optional                                     pam_systemd.so
session     [success=1 default=ignore]                   pam_succeed_if.so service in crond quiet use_uid
session     required                                     pam_unix.so
session     optional                                     pam_sss.so

[+] 2. /etc/pam.d/common-password 현황
파일이 존재하지 않습니다.

[+] 3. 현황 : /etc/security/pwquality.conf 상세 내용
# Configuration for systemwide password quality limits
# Defaults:
#
# Number of characters in the new password that must not be present in the
# old password.
# difok = 1
#
# Minimum acceptable size for the new password (plus one if
# credits are not disabled which is the default). (See pam_cracklib manual.)
# Cannot be set to lower value than 6.
minlen = 10 
#
# The maximum credit for having digits in the new password. If less than 0
# it is the minimum number of digits in the new password.
# dcredit = 0
#
# The maximum credit for having uppercase characters in the new password.
# If less than 0 it is the minimum number of uppercase characters in the new
# password.
# ucredit = 0
#
# The maximum credit for having lowercase characters in the new password.
# If less than 0 it is the minimum number of lowercase characters in the new
# password.
# lcredit = 0
#
# The maximum credit for having other characters in the new password.
# If less than 0 it is the minimum number of other characters in the new
# password.
# ocredit = 0
#
# The minimum number of required classes of characters for the new
# password (digits, uppercase, lowercase, others).
minclass = 2 
#
# The maximum number of allowed consecutive same characters in the new password.
# The check is disabled if the value is 0.
# maxrepeat = 0
#
# The maximum number of allowed consecutive characters of the same class in the
# new password.
# The check is disabled if the value is 0.
# maxclassrepeat = 0
#
# Whether to check for the words from the passwd entry GECOS string of the user.
# The check is enabled if the value is not 0.
# gecoscheck = 0
#
# Whether to check for the words from the cracklib dictionary.
# The check is enabled if the value is not 0.
# dictcheck = 1
#
# Whether to check if it contains the user name in some form.
# The check is enabled if the value is not 0.
# usercheck = 1
#
# Length of substrings from the username to check for in the password
# The check is enabled if the value is greater than 0 and usercheck is enabled.
# usersubstr = 0
#
# Whether the check is enforced by the PAM module and possibly other
# applications.
# The new password is rejected if it fails the check and the value is not 0.
# enforcing = 1
#
# Path to the cracklib dictionaries. Default is to use the cracklib default.
# dictpath =
#
# Prompt user at most N times before returning with error. The default is 1.
# retry = 3
#
# Enforces pwquality checks on the root user password.
# Enabled if the option is present.
# enforce_for_root
#
# Skip testing the password quality for users that are not present in the
# /etc/passwd file.
# Enabled if the option is present.
# local_users_only

[+] 4. 현황 : /etc/login.defs 상세 내용
#
# Please note that the parameters in this configuration file control the
# behavior of the tools from the shadow-utils component. None of these
# tools uses the PAM mechanism, and the utilities that use PAM (such as the
# passwd command) should therefore be configured elsewhere. Refer to
# /etc/pam.d/system-auth for more information.
#

#
# Delay in seconds before being allowed another attempt after a login failure
# Note: When PAM is used, some modules may enforce a minimum delay (e.g.
#       pam_unix(8) enforces a 2s delay)
#
#FAIL_DELAY		3

# Currently FAILLOG_ENAB is not supported

#
# Enable display of unknown usernames when login(1) failures are recorded.
#
#LOG_UNKFAIL_ENAB	no

# Currently LOG_OK_LOGINS is not supported

# Currently LASTLOG_ENAB is not supported

#
# Limit the highest user ID number for which the lastlog entries should
# be updated.
#
# No LASTLOG_UID_MAX means that there is no user ID limit for writing
# lastlog entries.
#
#LASTLOG_UID_MAX

# Currently MAIL_CHECK_ENAB is not supported

# Currently OBSCURE_CHECKS_ENAB is not supported

# Currently PORTTIME_CHECKS_ENAB is not supported

# Currently QUOTAS_ENAB is not supported

# Currently SYSLOG_SU_ENAB is not supported

#
# Enable "syslog" logging of newgrp(1) and sg(1) activity.
#
#SYSLOG_SG_ENAB		yes

# Currently CONSOLE is not supported

# Currently SULOG_FILE is not supported

# Currently MOTD_FILE is not supported

# Currently ISSUE_FILE is not supported

# Currently TTYTYPE_FILE is not supported

# Currently FTMP_FILE is not supported

# Currently NOLOGINS_FILE is not supported

# Currently SU_NAME is not supported

# *REQUIRED*
#   Directory where mailboxes reside, _or_ name of file, relative to the
#   home directory.  If you _do_ define both, MAIL_DIR takes precedence.
#
MAIL_DIR	/var/spool/mail
#MAIL_FILE	.mail

#
# If defined, file which inhibits all the usual chatter during the login
# sequence.  If a full pathname, then hushed mode will be enabled if the
# user's name or shell are found in the file.  If not a full pathname, then
# hushed mode will be enabled if the file exists in the user's home directory.
#
#HUSHLOGIN_FILE	.hushlogin
#HUSHLOGIN_FILE	/etc/hushlogins

# Currently ENV_TZ is not supported

# Currently ENV_HZ is not supported

#
# The default PATH settings, for superuser and normal users.
#
# (they are minimal, add the rest in the shell startup files)
#ENV_SUPATH	PATH=/sbin:/bin:/usr/sbin:/usr/bin
#ENV_PATH	PATH=/bin:/usr/bin

#
# Terminal permissions
#
#	TTYGROUP	Login tty will be assigned this group ownership.
#	TTYPERM		Login tty will be set to this permission.
#
# If you have a write(1) program which is "setgid" to a special group
# which owns the terminals, define TTYGROUP as the number of such group
# and TTYPERM as 0620.  Otherwise leave TTYGROUP commented out and
# set TTYPERM to either 622 or 600.
#
#TTYGROUP	tty
#TTYPERM		0600

# Currently ERASECHAR, KILLCHAR and ULIMIT are not supported

# Default initial "umask" value used by login(1) on non-PAM enabled systems.
# Default "umask" value for pam_umask(8) on PAM enabled systems.
# UMASK is also used by useradd(8) and newusers(8) to set the mode for new
# home directories if HOME_MODE is not set.
# 022 is the default value, but 027, or even 077, could be considered
# for increased privacy. There is no One True Answer here: each sysadmin
# must make up their mind.
UMASK		022

# HOME_MODE is used by useradd(8) and newusers(8) to set the mode for new
# home directories.
# If HOME_MODE is not set, the value of UMASK is used to create the mode.
HOME_MODE	0700

# Password aging controls:
#
#	PASS_MAX_DAYS	Maximum number of days a password may be used.
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
#	PASS_MIN_LEN	Minimum acceptable password length.
#	PASS_WARN_AGE	Number of days warning given before a password expires.
#
PASS_MAX_DAYS	90
PASS_MIN_DAYS	1
PASS_WARN_AGE	7

# Currently PASS_MIN_LEN is not supported

# Currently SU_WHEEL_ONLY is not supported

# Currently CRACKLIB_DICTPATH is not supported

#
# Min/max values for automatic uid selection in useradd(8)
#
UID_MIN                  1000
UID_MAX                 60000
# System accounts
SYS_UID_MIN               201
SYS_UID_MAX               999
# Extra per user uids
SUB_UID_MIN		   100000
SUB_UID_MAX		600100000
SUB_UID_COUNT		    65536

#
# Min/max values for automatic gid selection in groupadd(8)
#
GID_MIN                  1000
GID_MAX                 60000
# System accounts
SYS_GID_MIN               201
SYS_GID_MAX               999
# Extra per user group ids
SUB_GID_MIN		   100000
SUB_GID_MAX		600100000
SUB_GID_COUNT		    65536

#
# Max number of login(1) retries if password is bad
#
#LOGIN_RETRIES		3

#
# Max time in seconds for login(1)
#
#LOGIN_TIMEOUT		60

# Currently PASS_CHANGE_TRIES is not supported

# Currently PASS_ALWAYS_WARN is not supported

# Currently PASS_MAX_LEN is not supported

# Currently CHFN_AUTH is not supported

#
# Which fields may be changed by regular users using chfn(1) - use
# any combination of letters "frwh" (full name, room number, work
# phone, home phone).  If not defined, no changes are allowed.
# For backward compatibility, "yes" = "rwh" and "no" = "frwh".
# 
#CHFN_RESTRICT		rwh

# Currently LOGIN_STRING is not supported

# Currently MD5_CRYPT_ENAB is not supported

#
# If set to MD5, MD5-based algorithm will be used for encrypting password
# If set to SHA256, SHA256-based algorithm will be used for encrypting password
# If set to SHA512, SHA512-based algorithm will be used for encrypting password
# If set to BLOWFISH, BLOWFISH-based algorithm will be used for encrypting password
# If set to DES, DES-based algorithm will be used for encrypting password (default)
#
ENCRYPT_METHOD SHA512

#
# Only works if ENCRYPT_METHOD is set to SHA256 or SHA512.
#
# Define the number of SHA rounds.
# With a lot of rounds, it is more difficult to brute-force the password.
# However, more CPU resources will be needed to authenticate users if
# this value is increased.
#
# If not specified, the libc will choose the default number of rounds (5000).
# The values must be within the 1000-999999999 range.
#
SHA_CRYPT_MAX_ROUNDS 100000

# Currently SHA_CRYPT_MIN_ROUNDS is not supported

# Currently BCRYPT_MIN_ROUNDS and BCRYPT_MAX_ROUNDS are not supported

# Currently CONSOLE_GROUPS is not supported

#
# Should login be allowed if we can't cd to the home directory?
# Default is yes.
#
#DEFAULT_HOME	yes

# Currently ENVIRON_FILE is not supported

#
# If defined, this command is run when removing a user.
# It should remove any at/cron/print jobs etc. owned by
# the user to be removed (passed as the first argument).
#
#USERDEL_CMD	/usr/sbin/userdel_local

#
# Enables userdel(8) to remove user groups if no members exist.
#
USERGROUPS_ENAB yes

#
# If set to a non-zero number, the shadow utilities will make sure that
# groups never have more than this number of users on one line.
# This permits to support split groups (groups split into multiple lines,
# with the same group ID, to avoid limitation of the line length in the
# group file).
#
# 0 is the default value and disables this feature.
#
#MAX_MEMBERS_PER_GROUP	0

#
# If useradd(8) should create home directories for users by default (non
# system users only).
# This option is overridden with the -M or -m flags on the useradd(8)
# command-line.
#
CREATE_HOME	yes

#
# Force use shadow, even if shadow passwd & shadow group files are
# missing.
#
#FORCE_SHADOW    yes

#
# Select the HMAC cryptography algorithm.
# Used in pam_timestamp module to calculate the keyed-hash message
# authentication code.
#
# Note: It is recommended to check hmac(3) to see the possible algorithms
# that are available in your system.
#
HMAC_CRYPTO_ALGO SHA512

[+] 4-1. 현황 : PASS_MIN_DAYS 내용
#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
PASS_MIN_DAYS	1



[U-48_END]
=============================================
[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : 영문 숫자 특수문자 2개 조합 시 10자리 이상, 3개 조합 시 8자리 이상, 패스워드 변경 기간 90일 이하 또는 내부 정책에 맞게 설정된 경우
 * 취약 기준 : 비밀번호 조합규칙 및 길이 미흡, 패스워드 변경 기간 90 이상인 경우
=============================================




[U-49] 불필요한 계정 제거
[U-49_START]
=============================================
[+] 1. 현황 : /etc/passwd 내 활성화 계정만 출력함
root:x:0:0:root:/root:/bin/bash
jian:x:1000:1000::/home/jian:/bin/bash
lynsecure:x:1001:1001::/home/lynsecure:/bin/bash

[+] 2. 현황 : 전체 계정의 접속 기록 중 활성화 계정만 출력함
[+] root 접속 기록
root     tty1                          Thu Jun 12 14:29 - crash  (00:32)
root     tty1                          Thu Jun 12 23:21 - down   (-8:52)
root     tty1                          Thu Jun 12 23:14 - down   (00:06)

Last password change					: Jun 23, 2025
Password expires					: never
Password inactive					: never
Account expires						: never
Minimum number of days between password change		: 0
Maximum number of days between password change		: 99999
Number of days of warning before password expires	: 7

[+] jian 접속 기록
jian     pts/0        192.168.10.1     Tue Jul  1 10:02   still logged in
jian     pts/0        192.168.10.1     Mon Jun 30 16:40 - 17:14  (00:34)
jian     pts/0        192.168.10.1     Mon Jun 30 11:59 - 16:40  (04:40)

Last password change					: Jun 12, 2025
Password expires					: never
Password inactive					: never
Account expires						: never
Minimum number of days between password change		: 0
Maximum number of days between password change		: 99999
Number of days of warning before password expires	: 7

[+] lynsecure 접속 기록
lynsecur pts/1        192.168.10.1     Tue Jun 24 11:12 - crash  (03:16)
lynsecur tty1                          Mon Jun 23 17:43 - 17:43  (00:00)
lynsecur pts/0        192.168.10.1     Mon Jun 23 17:41 - 17:42  (00:00)

Last password change					: Jun 24, 2025
Password expires					: never
Password inactive					: never
Account expires						: never
Minimum number of days between password change		: 0
Maximum number of days between password change		: 99999
Number of days of warning before password expires	: 7

=============================================
[U-49_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 분기별 1회 이상 로그인 한 기록이 있고, 비밀번호를 변경하고 있는 경우
 * 취약 조건 : 분기별 1회 이상 로그인 한 기록이 없거나, 비밀번호를 변경하지 않은 경우
[*] 기준에 부합하지 않는 계정 존재 확인 (분기별 1회 이상 로그인 또는 패스워드 변경)
[*] 마지막 로그인 시간 확인
[*] 마지막 패스워드 변경 시간 확인
=============================================




[U-50] 관리자 그룹에 최소한의 계정 포함
[U-50_START]
=============================================
[+] 1. 현황 : root가 포함된 group 확인
root:x:0:

[+] 2. 현황 : /etc/group 파일 확인
root:x:0:
bin:x:1:
daemon:x:2:
sys:x:3:
adm:x:4:
tty:x:5:
disk:x:6:
lp:x:7:
mem:x:8:
kmem:x:9:
wheel:x:10:jian
cdrom:x:11:
mail:x:12:
man:x:15:
dialout:x:18:
floppy:x:19:
games:x:20:
tape:x:33:
video:x:39:
ftp:x:50:
lock:x:54:
audio:x:63:
users:x:100:
nobody:x:65534:
utmp:x:22:
utempter:x:35:
unbound:x:999:
input:x:998:
kvm:x:36:
render:x:997:
systemd-journal:x:190:
systemd-coredump:x:996:
dbus:x:81:
polkitd:x:995:
printadmin:x:994:
ssh_keys:x:993:
libstoragemgmt:x:992:
tss:x:59:clevis
cockpit-ws:x:991:
sssd:x:989:
setroubleshoot:x:988:
clevis:x:987:
sshd:x:74:
chrony:x:986:
slocate:x:21:
tcpdump:x:72:
sgx:x:985:
systemd-oom:x:984:
systemd-resolve:x:983:
jian:x:1000:
apache:x:48:
saslauth:x:76:
mailnull:x:47:
smmsp:x:51:
named:x:25:
lynsecure:x:1001:
rpc:x:32:
rpcuser:x:29:

=============================================
[U-50_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 관리자 그룹에 불필요한 관리자 계정이 없을 경우
 * 취약 조건 : 관리자 그룹에 불필요한 관리자 계정이 있을 경우
=============================================




[U-51] 계정이 존재하지 않는 GID 금지
[U-51_START]
=============================================
[+] 1. 현황 : /etc/group 그룹 확인
root:x:0:
bin:x:1:
daemon:x:2:
sys:x:3:
adm:x:4:
tty:x:5:
disk:x:6:
lp:x:7:
mem:x:8:
kmem:x:9:
wheel:x:10:jian
cdrom:x:11:
mail:x:12:
man:x:15:
dialout:x:18:
floppy:x:19:
games:x:20:
tape:x:33:
video:x:39:
ftp:x:50:
lock:x:54:
audio:x:63:
users:x:100:
nobody:x:65534:
utmp:x:22:
utempter:x:35:
unbound:x:999:
input:x:998:
kvm:x:36:
render:x:997:
systemd-journal:x:190:
systemd-coredump:x:996:
dbus:x:81:
polkitd:x:995:
printadmin:x:994:
ssh_keys:x:993:
libstoragemgmt:x:992:
tss:x:59:clevis
cockpit-ws:x:991:
sssd:x:989:
setroubleshoot:x:988:
clevis:x:987:
sshd:x:74:
chrony:x:986:
slocate:x:21:
tcpdump:x:72:
sgx:x:985:
systemd-oom:x:984:
systemd-resolve:x:983:
jian:x:1000:
apache:x:48:
saslauth:x:76:
mailnull:x:47:
smmsp:x:51:
named:x:25:
lynsecure:x:1001:
rpc:x:32:
rpcuser:x:29:

[+] 2. 현황 : /etc/passwd 확인
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:65534:65534:Kernel Overflow User:/:/sbin/nologin
unbound:x:999:999:Unbound DNS resolver:/etc/unbound:/sbin/nologin
systemd-coredump:x:998:996:systemd Core Dumper:/:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
polkitd:x:997:995:User for polkitd:/:/sbin/nologin
libstoragemgmt:x:996:992:daemon account for libstoragemgmt:/var/run/lsm:/sbin/nologin
tss:x:59:59:Account used for TPM access:/dev/null:/sbin/nologin
cockpit-ws:x:995:991:User for cockpit web service:/nonexisting:/sbin/nologin
sssd:x:993:989:User for sssd:/:/sbin/nologin
setroubleshoot:x:992:988::/var/lib/setroubleshoot:/sbin/nologin
clevis:x:991:987:Clevis Decryption Framework unprivileged user:/var/cache/clevis:/usr/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/usr/share/empty.sshd:/sbin/nologin
chrony:x:990:986::/var/lib/chrony:/sbin/nologin
tcpdump:x:72:72::/:/sbin/nologin
systemd-oom:x:984:984:systemd Userspace OOM Killer:/:/usr/sbin/nologin
systemd-resolve:x:983:983:systemd Resolver:/:/usr/sbin/nologin
jian:x:1000:1000::/home/jian:/bin/bash
apache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin
saslauth:x:982:76:Saslauthd user:/run/saslauthd:/sbin/nologin
mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin
smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin
named:x:25:25:Named:/var/named:/sbin/nologin
lynsecure:x:1001:1001::/home/lynsecure:/bin/bash
rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin

[+] 3. 현황 : /etc/gshadow 확인
root:::
bin:::
daemon:::
sys:::
adm:::
tty:::
disk:::
lp:::
mem:::
kmem:::
wheel:::jian
cdrom:::
mail:::
man:::
dialout:::
floppy:::
games:::
tape:::
video:::
ftp:::
lock:::
audio:::
users:::
nobody:::
utmp:!::
utempter:!::
unbound:!::
input:!::
kvm:!::
render:!::
systemd-journal:!::
systemd-coredump:!::
dbus:!::
polkitd:!::
printadmin:!::
ssh_keys:!::
libstoragemgmt:!::
tss:!::clevis
cockpit-ws:!::
sssd:!::
setroubleshoot:!::
clevis:!::
sshd:!::
chrony:!::
slocate:!::
tcpdump:!::
sgx:!*::
systemd-oom:!*::
systemd-resolve:!*::
jian:!::
apache:!::
saslauth:!::
mailnull:!::
smmsp:!::
named:!::
lynsecure:!::
rpc:!::
rpcuser:!::

=============================================
[U-51_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 구성원이 존재하지 않는 GID가 존재하지 않는 경우
 * 취약 조건 : 구성원이 존재하지 않는 GID가 존재하는 경우
=============================================




[U-52] 동일한 UID 금지
[U-52_START]
=============================================
[+] 1. 현황 : /etc/passwd에서 UID 추출
root = 0
bin = 1
daemon = 2
adm = 3
lp = 4
sync = 5
shutdown = 6
halt = 7
mail = 8
operator = 11
games = 12
ftp = 14
nobody = 65534
unbound = 999
systemd-coredump = 998
dbus = 81
polkitd = 997
libstoragemgmt = 996
tss = 59
cockpit-ws = 995
sssd = 993
setroubleshoot = 992
clevis = 991
sshd = 74
chrony = 990
tcpdump = 72
systemd-oom = 984
systemd-resolve = 983
jian = 1000
apache = 48
saslauth = 982
mailnull = 47
smmsp = 51
named = 25
lynsecure = 1001
rpc = 32
rpcuser = 29

[+] 2. 중복된 UID 확인

[+] 중복된 UID가 존재하지 않습니다.

=============================================
[U-52_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 동일한 UID로 설정된 사용자 계정이 존재하지 않는 경우
 * 취약 조건 : 동일한 UID로 설정된 사용자 계정이 존재하는 경우
=============================================




[U-53] 사용자 shell 점검
[U-53_START]
=============================================
[+] 활성화 계정 중 불필요한 계정 확인.
root:x:0:0:root:/root:/bin/bash
jian:x:1000:1000::/home/jian:/bin/bash
lynsecure:x:1001:1001::/home/lynsecure:/bin/bash

=============================================
[U-53_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 로그인이 필요하지 않은 계정에 /bin/false(nologin) 등이 부여된 경우
 * 취약 조건 : 로그인이 필요하지 않은 계정에 shell이 부여된 경우
=============================================




[U-54] Session Timeout 설정
[U-54_START]
=============================================
[+] /etc/profile 설정 확인

[+] 관련 설정이 존재하지 않습니다.


[U-54_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 세션 타임아웃 값이 600초 이하(10분)로 설정 되어 있을 경우
 * 취약 조건 :  세션 타임아웃 값이 600초 이하(10분)로 설정 되어 있지 않을 경우 (아래 내용 중 해당사항이 있는 경우)
************************************************
1) 내부 규정에 세션 종료 시간이 명시되어있는 경우
    - 세션 타임아웃이 내부 규정에 명시된 세션 종료 시간보다 초과 설정 시 취약으로 진단
2) 내부 규정에 세션 종료시간이 명시되어 있지 않을 경우
    - 세션타임아웃이 10분 초과 설정 시 취약으로 진단
=============================================




[U-05] root 홈, 패스 디렉토리 권한 및 패스 설정
[U-05_START]
=============================================
[+] 현황 : PATH 환경변수 확인
/root/.local/bin:/root/bin:/sbin:/bin:/usr/sbin:/usr/bin

=============================================
[U-05_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : PATH 환경변수에 “.” 이 맨 앞이나 중간에 포함되지 않은 경우
 * 취약 조건 : PATH 환경변수에 “.” 이 맨 앞이나 중간에 포함되어 있는 경우
=============================================




[U-06] 파일 및 디렉토리 소유자 설정
[U-06_START]
=============================================
[+] 소유자가 존재하지 않는 파일 출력
-rw-r--r--. 1 1002 1002 18 Feb 16  2024 /home/test/.bash_logout
-rw-r--r--. 1 1002 1002 141 Feb 16  2024 /home/test/.bash_profile
-rw-r--r--. 1 1002 1002 492 Feb 16  2024 /home/test/.bashrc
-rw-r--r--. 1 1002 1002 5 Jun 30 14:24 /home/test/test_dir/ringdingdong.txt
-rw-r--r--. 1 1002 1002 5 Jun 30 14:24 /home/test/nononono.txt
-rw-------. 1 1002 1002 133 Jun 30 14:25 /home/test/.bash_history
-rw-rw----. 1 1002 mail 0 Jun 30 14:24 /var/spool/mail/test

[+] 소유자 그룹이 존재하지 않는 파일 출력
-rw-r--r--. 1 1002 1002 18 Feb 16  2024 /home/test/.bash_logout
-rw-r--r--. 1 1002 1002 141 Feb 16  2024 /home/test/.bash_profile
-rw-r--r--. 1 1002 1002 492 Feb 16  2024 /home/test/.bashrc
-rw-r--r--. 1 1002 1002 5 Jun 30 14:24 /home/test/test_dir/ringdingdong.txt
-rw-r--r--. 1 1002 1002 5 Jun 30 14:24 /home/test/nononono.txt
-rw-------. 1 1002 1002 133 Jun 30 14:25 /home/test/.bash_history

=============================================
[U-06_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 존재하지 않는 소유자 및 그룹 권한을 가진 파일 또는 디렉토리 존재
 * 취약 조건 : 소유자가 존재하지 않는 파일 디렉토리 중 중요한 파일인지 확인
=============================================




[U-07] /etc/passwd 파일 소유자 및 권한 설정
[U-07_START]
=============================================

[+] /etc/passwd
-rw-r--r--. 1 root root 1947 Jun 30 14:25 /etc/passwd

[U-07_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
1. /etc/passwd 권한: 644, 소유자 root
1-2. /etc/security/passwd 권한: 644, 소유자 root
*** 존재하고있는 파일 및 디렉토리만 출력 ***
=============================================




[U-08] /etc/shadow 파일 소유자 및 권한 설정
[U-08_START]
=============================================

[+] /etc/shadow
----------. 1 root root 1275 Jun 30 14:25 /etc/shadow

[U-08_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
1. /etc/shadow 권한: 400, 소유자 root 
*** 존재하고있는 파일 및 디렉토리만 출력 ***
=============================================




[U-09] /etc/hosts 파일 소유자 및 권한 설정
[U-09_START]
=============================================

[+] /etc/hosts
-rw-r--r--. 1 root root 189 Jun 16 15:09 /etc/hosts

[U-09_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
1. /etc/hosts 권한: 600, 소유자 root
=============================================




[U-10] /etc/(x)inetd.conf 파일 소유자 및 권한 설정
[U-10_START]
=============================================
파일이 존재하지 않습니다. /etc/inetd.conf
파일이 존재하지 않습니다. /etc/xinetd.conf

[U-10_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
1. /etc/(x)inetd.conf 권한: 600, 소유자 root
=============================================




[U-11] /etc/syslog.conf 파일 소유자 및 권한 설정
[U-11_START]
=============================================
파일이 존재하지 않습니다. /etc/syslog.conf

[+] /etc/rsyslog.conf
-rw-r--r--. 1 root root 3380 May  7 22:14 /etc/rsyslog.conf

[U-11_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
1. /etc/(r)syslog.conf 권한: 640, 소유자 root
=============================================




[U-12] /etc/services 파일 소유자 및 권한 설정
[U-12_START]
=============================================

[+] /etc/services
-rw-r--r--. 1 root root 692252 Jun 23  2020 /etc/services

[U-12_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
1. /etc/services 권한:  644, 소유자 root
=============================================




[U-13] SUID, SGID, Sticky bit 설정 파일 점검
[U-13_START]
=============================================
[+] SUID, SGID, Sticky bit가 설정된 파일 출력(최대 5개)
-rwsr-xr-x. 1 root root 73704 May 27 00:31 /usr/bin/chage
-rwsr-xr-x. 1 root root 78016 May 27 00:31 /usr/bin/gpasswd
-rwsr-xr-x. 1 root root 41744 May 27 00:31 /usr/bin/newgrp
-rwsr-xr-x. 1 root root 48648 Jan 17 01:59 /usr/bin/mount
-rwsr-xr-x. 1 root root 36280 Jan 17 01:59 /usr/bin/umount

=============================================
[U-13_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 불필요하게 SUID ,SGID가 설정된 파일이 없을 경우 판단 불가 시 4750(업무상 용도 포함)
 * 취약 조건 : 불필요하게 SUID ,SGID가 설정된 파일이 있을 경우
=============================================




[U-14] 사용자, 시스템 시작파일 및 환경파일 소유자 및 권한 설정
[U-14_START]
=============================================
[+] 1. 현황 : 환경변수 파일 확인
[*] /bin
파일이 존재하지 않습니다.
[*] /etc/unbound
파일이 존재하지 않습니다.
[*] /home/jian
-rw-r--r--. 1 jian jian 141 Aug 10  2021 /home/jian/.bash_profile
-rw-r--r--. 1 jian jian 492 Aug 10  2021 /home/jian/.bashrc
-rw-r--r--. 1 root root 11 Jul  1 13:12 /home/jian/.test_profile
[*] /home/lynsecure
-rw-r--r--. 1 lynsecure lynsecure 141 Feb 16  2024 /home/lynsecure/.bash_profile
-rw-r--r--. 1 lynsecure lynsecure 492 Feb 16  2024 /home/lynsecure/.bashrc
[*] /root
-rw-r--r--. 1 root root 141 Aug 10  2021 /root/.bash_profile
-rw-r--r--. 1 root root 100 Aug 10  2021 /root/.cshrc
-rw-r--r--. 1 root root 129 Aug 10  2021 /root/.tcshrc
-rw-r--r--. 1 root root 429 Jun 25 15:22 /root/.bashrc
[*] /sbin
파일이 존재하지 않습니다.
[*] /usr/games
파일이 존재하지 않습니다.
[*] /usr/share/empty.sshd
파일이 존재하지 않습니다.
[*] /usr/share/httpd
파일이 존재하지 않습니다.
[*] /var/adm
파일이 존재하지 않습니다.
[*] /var/ftp
파일이 존재하지 않습니다.
[*] /var/lib/chrony
파일이 존재하지 않습니다.
[*] /var/lib/nfs
파일이 존재하지 않습니다.
[*] /var/lib/rpcbind
파일이 존재하지 않습니다.
[*] /var/lib/setroubleshoot
파일이 존재하지 않습니다.
[*] /var/named
파일이 존재하지 않습니다.
[*] /var/run/lsm
파일이 존재하지 않습니다.
[*] /var/spool/lpd
파일이 존재하지 않습니다.
[*] /var/spool/mail
파일이 존재하지 않습니다.
[*] /var/spool/mqueue
파일이 존재하지 않습니다.
=============================================
[U-14_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 홈디렉토리 환경변수 파일 소유자가 root 또는, 해당 계정으로 지정되어 있고, 홈디렉토리 환경변수 파일에 root와 소유자만 쓰기 권한이 부여
된 경우
 * 취약 조건 : 홈디렉토리 환경변수 파일 소유자가 root 또는, 해당 계정으로 지정되지 않고, 홈디렉토리 환경변수 파일에 root와 소유자 외에 쓰기 권한이 
부여된 경우
=============================================




[U-15] world writable 파일 점검
[U-15_START]
=============================================
[+] world writable 파일 확인
-rwxrwxrwx. 1 lynsecure root 0 Jul  1 11:51 /home/jian/test/perm_test.txt

=============================================
[U-15_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 불필요한 world writable 파일이 존재하지 않는 경우 & others에 쓰기권한 없으면 양호
 * 취약 조건 : 불필요한 world writable 파일이 존재하는 경우
=============================================




[U-16] /dev에 존재하지 않는 device 파일 점검
[U-16_START]
=============================================
[+] 현황 : find /dev -type f -exec ls -l {} \;
-rw-r--r--. 1 root root 596 Jul  1 15:54 /dev/nul


=============================================
[U-16_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : /dev 경로에 존재하지 않는 device 파일이 없는 경우
 * 취약 조건 : /dev 경로에 존재하지 않는 불필요한 device 파일이 있는 경우  
=============================================




[U-17] /root/.rhosts, hosts.equiv 사용 금지
[U-17_START]
=============================================
[+] 관련 설정이 존재하지 않습니다.
[+] 관련 설정이 존재하지 않습니다.
[U-17_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
[*] 미출력 시 파일이 미존재
 * 양호 조건 : login, shell, exec 서비스를 사용하지 않거나, 사용 시 아래와 같은 설정이 적용된 경우
 * 양호 조건 1 : 1. /etc/hosts.equiv 및 /root/.rhosts 파일 소유자가 root 또는, 해당 계정인 경우 
 * 양호 조건 2 : 2. /etc/hosts.equiv 및 /root/.rhosts 파일 권한이 600 이하인 경우 
 * 양호 조건 3 : 3. /etc/hosts.equiv 및 /root/.rhosts 파일 설정에 ‘+’ 설정이 없는 경우
 * 취약 조건 : login, shell, exec 서비스를 사용하고, 위와 같은 설정이 적용되지 않은 경우
=============================================




[U-18] 접속 IP 및 포트 제한
[U-18_START]
=============================================
[+] /etc/hosts.allow
/etc/hosts.allow 파일이 존재하지 않습니다.

[+] /etc/hosts.deny
/etc/hosts.deny 파일이 존재하지 않습니다.


[U-18_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 시스템 서비스로의 접근통제가 적절하게 수행되고 있을 경우 (방화벽, tcp-wrapper, 3rd-party 제품 등을 활용) 또는 예시( /etc/hosts.allow - sshd : IP주소 (접근을 허용할 호스트) && /etc/hosts.deny - ALL:ALL (ALL Deny 설정))
 * 취약 조건 : 시스템 서비스로의 접근통제가 적절하게 수행되고 있지 않을 경우 또는 관련설정 없을 시 
=============================================




[U-55] hosts.lpd 파일 소유자 및 권한 설정
[U-55_START]
=============================================

[U-55_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
1. /etc/hosts.lpd 권한: 600, 소유자 root
=============================================




[U-56] UMASK 설정 관리
[U-56_START]
=============================================
[+] 1. 현황 : /etc/security/user 설정 
파일이 존재하지 않습니다.

[+] 2. 현황 : /etc/profile

[+] 3. 현황 : 모든 계정의 홈디렉토리 내 .*profile .*shrc 확인
 [*] /home/jian/.bash_profile
 UMASK 설정 없음
 [*] /home/jian/.bashrc
 UMASK 설정 없음
 [*] /home/jian/.test_profile
 UMASK 0000
 [*] /home/lynsecure/.bash_profile
 UMASK 설정 없음
 [*] /home/lynsecure/.bashrc
 UMASK 설정 없음
 [*] /root/.bash_profile
 UMASK 설정 없음
 [*] /root/.cshrc
 UMASK 설정 없음
 [*] /root/.tcshrc
 UMASK 설정 없음
 [*] /root/.bashrc
 UMASK 설정 없음

[+] 4. 현황 : 현재 접속 계정 UMASK 설정
0022

=============================================
[U-56_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 모든 계정의 umask 값과 설정 파일 등에 적용된 umask값이 022 이상인 경우
 * 취약 조건 : umask값이나 설정 파일 등에 적용된 umask값이 022미만인 계정이 존재하는 경우
=============================================




[U-57] 홈디렉토리 소유자 및 권한 설정
[U-57_START]
=============================================
[+] 소유자 별 홈디렉토리 확인 (소유자 @ 홈디렉토리 < 형태이며, 중복 홈디렉토리와 소유자별 디렉토리 일치하는지 확인)
adm @ /var/adm
apache @ /usr/share/httpd
bin @ /bin
chrony @ /var/lib/chrony
clevis @ /var/cache/clevis
cockpit-ws @ /nonexisting
daemon @ /sbin
dbus @ /
ftp @ /var/ftp
games @ /usr/games
halt @ /sbin
jian @ /home/jian
libstoragemgmt @ /var/run/lsm
lp @ /var/spool/lpd
lynsecure @ /home/lynsecure
mail @ /var/spool/mail
mailnull @ /var/spool/mqueue
named @ /var/named
nobody @ /
operator @ /root
polkitd @ /
root @ /root
rpc @ /var/lib/rpcbind
rpcuser @ /var/lib/nfs
saslauth @ /run/saslauthd
setroubleshoot @ /var/lib/setroubleshoot
shutdown @ /sbin
smmsp @ /var/spool/mqueue
sshd @ /usr/share/empty.sshd
sssd @ /
sync @ /sbin
systemd-coredump @ /
systemd-oom @ /
systemd-resolve @ /
tcpdump @ /
tss @ /dev/null
unbound @ /etc/unbound

[+] 홈디렉토리의 권한 확인 (불필요한 others 쓰기권한)
lrwxrwxrwx. 1 root root 7 Jun 25  2024 /bin -> usr/bin
drwxr-xr-x. 2 root root 45 Jun 17 14:30 /etc/unbound
drwx------. 5 jian jian 4096 Jul  1 15:56 /home/jian
drwx------. 2 lynsecure lynsecure 115 Jun 18 14:05 /home/lynsecure
dr-xr-x---. 3 root root 4096 Jul  1 12:14 /root
lrwxrwxrwx. 1 root root 8 Jun 25  2024 /sbin -> usr/sbin
drwxr-xr-x. 2 root root 6 Jun 25  2024 /usr/games
drwx--x--x. 2 root root 6 Feb 18 20:01 /usr/share/empty.sshd
drwxr-xr-x. 6 root root 68 Jun 12 15:23 /usr/share/httpd
drwxr-xr-x. 2 root root 6 Jun 25  2024 /var/adm
drwxr-xr-x. 3 root root 17 Jun 18 14:59 /var/ftp
drwxr-x---. 2 chrony chrony 19 Jun 23 17:42 /var/lib/chrony
drwxr-xr-x. 6 root root 119 Jun 25 14:52 /var/lib/nfs
drwxr-xr-x. 2 rpc rpc 6 Jun 19 14:42 /var/lib/rpcbind
drwx------. 2 setroubleshoot setroubleshoot 71 Mar 17 20:16 /var/lib/setroubleshoot
drwxrwx--T. 6 root named 4096 Jun 23 17:42 /var/named
drwxrwxr-x. 3 root libstoragemgmt 60 Jun 25 14:52 /var/run/lsm
drwxr-xr-x. 2 root root 6 Jun 25  2024 /var/spool/lpd
drwxrwxr-x. 2 root mail 70 Jun 30 14:24 /var/spool/mail
drwx------. 2 root mail 6 Jun 23 17:43 /var/spool/mqueue

=============================================
[U-57_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 홈디렉토리의 소유자와 실 사용자가 일치하고, 계정간 중복 홈디렉토리가 존재하지 않고, 불필요한 others 쓰기 권한이 없는 경우
 * 취약 조건 : 홈디렉토리의 소유자와 실 사용자가 일치하지 않거나, 계정간 중복 홈디렉토리가 존재하거나, 불필요한 others 쓰기 권한이 있는 경우
=============================================




[U-58] 홈디렉토리로 지정한 디렉토리의 존재 관리
[U-58_START]
=============================================
[+] 소유자 별 홈디렉토리 확인 (소유자 @ 홈디렉토리 < 형태이며, 중복 홈디렉토리와 소유자별 디렉토리 일치하는지 확인)
adm @ /var/adm
apache @ /usr/share/httpd
bin @ /bin
chrony @ /var/lib/chrony
clevis @ /var/cache/clevis
cockpit-ws @ /nonexisting
daemon @ /sbin
dbus @ /
ftp @ /var/ftp
games @ /usr/games
halt @ /sbin
jian @ /home/jian
libstoragemgmt @ /var/run/lsm
lp @ /var/spool/lpd
lynsecure @ /home/lynsecure
mail @ /var/spool/mail
mailnull @ /var/spool/mqueue
named @ /var/named
nobody @ /
operator @ /root
polkitd @ /
root @ /root
rpc @ /var/lib/rpcbind
rpcuser @ /var/lib/nfs
saslauth @ /run/saslauthd
setroubleshoot @ /var/lib/setroubleshoot
shutdown @ /sbin
smmsp @ /var/spool/mqueue
sshd @ /usr/share/empty.sshd
sssd @ /
sync @ /sbin
systemd-coredump @ /
systemd-oom @ /
systemd-resolve @ /
tcpdump @ /
tss @ /dev/null
unbound @ /etc/unbound

[+] 홈디렉토리의 권한 확인 (불필요한 others 쓰기권한)
lrwxrwxrwx. 1 root root 7 Jun 25  2024 /bin -> usr/bin
drwxr-xr-x. 2 root root 45 Jun 17 14:30 /etc/unbound
drwx------. 5 jian jian 4096 Jul  1 15:56 /home/jian
drwx------. 2 lynsecure lynsecure 115 Jun 18 14:05 /home/lynsecure
dr-xr-x---. 3 root root 4096 Jul  1 12:14 /root
lrwxrwxrwx. 1 root root 8 Jun 25  2024 /sbin -> usr/sbin
drwxr-xr-x. 2 root root 6 Jun 25  2024 /usr/games
drwx--x--x. 2 root root 6 Feb 18 20:01 /usr/share/empty.sshd
drwxr-xr-x. 6 root root 68 Jun 12 15:23 /usr/share/httpd
drwxr-xr-x. 2 root root 6 Jun 25  2024 /var/adm
drwxr-xr-x. 3 root root 17 Jun 18 14:59 /var/ftp
drwxr-x---. 2 chrony chrony 19 Jun 23 17:42 /var/lib/chrony
drwxr-xr-x. 6 root root 119 Jun 25 14:52 /var/lib/nfs
drwxr-xr-x. 2 rpc rpc 6 Jun 19 14:42 /var/lib/rpcbind
drwx------. 2 setroubleshoot setroubleshoot 71 Mar 17 20:16 /var/lib/setroubleshoot
drwxrwx--T. 6 root named 4096 Jun 23 17:42 /var/named
drwxrwxr-x. 3 root libstoragemgmt 60 Jun 25 14:52 /var/run/lsm
drwxr-xr-x. 2 root root 6 Jun 25  2024 /var/spool/lpd
drwxrwxr-x. 2 root mail 70 Jun 30 14:24 /var/spool/mail
drwx------. 2 root mail 6 Jun 23 17:43 /var/spool/mqueue
=============================================
[U-58_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 홈디렉토리가 존재하지 않는 계정이 발견되지 않는 경우
 * 취약 조건 : 홈디렉토리가 존재하지 않는 계정이 발견된 경우
=============================================




[U-59] 숨겨진 파일 및 디렉토리 검색 및 제거
[U-59_START]
=============================================
[+] 1. 현황 : 불필요한 숨김 파일 확인(최대 5개)
-rw-r--r--. 1 root root 165 Dec 24  2021 /boot/.vmlinuz-5.14.0-39.el9.x86_64.hmac
-rw-r--r--. 1 root root 160 May 31 06:24 /boot/.vmlinuz-5.14.0-590.el9.x86_64.hmac
-rw-r--r--. 1 jian jian 18 Aug 10  2021 /home/jian/.bash_logout
-rw-r--r--. 1 jian jian 141 Aug 10  2021 /home/jian/.bash_profile
-rw-r--r--. 1 jian jian 492 Aug 10  2021 /home/jian/.bashrc

[+] 2. 현황 : 불필요한 숨김 디렉토리 확인(최대 5개)
/home/jian/.vim
/tmp/.X11-unix
/tmp/.ICE-unix
/tmp/.XIM-unix
/tmp/.font-unix
=============================================
[U-59_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 불필요한 숨김 파일이 존재하지 않을 경우
 * 취약 조건 : 불필요한 숨김 파일이 존재하는 경우
=============================================




[U-19] finger 서비스 비활성화
[U-19_START]
=============================================
[+] 해당 서비스가 비활성화되어 있습니다.


[+] xinetd 활성화 서비스 목록
[+] xinetd 디렉토리가 존재하지 않습니다.


[U-19_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 아래의 항목 중 해당사항이 없는경우
 * 취약 조건 : 아래의 항목 중 해당하는 조건이 있는 경우
*********************************************
1. finger 서비스 활성화
*********************************************
=============================================




[U-20] Anonymous FTP 비활성화
[U-20_START]
=============================================
[+] FTP 서비스 활성화 확인 
 [+] FTP 서비스가 활성화 중입니다.
 [+]  vsftpd :  1
 [+]  proftpd :  0
 [*] 활성화(1), 비활성화(0)

 [*] 이외 ftp 확인
root         903       1  0 Jun30 ?        00:00:00 /usr/sbin/vsftpd /etc/vsftpd/vsftpd.conf
jian       55880   55879  0 10:01 ?        00:00:00 /usr/libexec/openssh/sftp-server

[+] 1. FTP 기본계정 로그인 쉘
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin

[+] 2. FTP 설정 현황
[+] /etc/vsftpd/vsftpd.conf
anonymous_enable=NO

[U-20_END]
=============================================
[*] FTP 포트 활성화 확인 
tcp6       0      0 :::21                   :::*                    LISTEN     

[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : 익명 FTP 사용 설정이 비활성화되어 있거나(AND), FTP 기본 계정 로그인 쉘이 비활성화(false/nologin)되어 있는 경우
 * 취약 기준 : 익명 FTP 사용 설정이 활성화되어 있거나(AND), FTP 기본 계정 로그인 쉘이 활성화(shell)되어 있는 경우
 *** 결과 파일이 출력된다는 것은 해당 서비스가 활성화(Active-Running) 상태이기 때문에 출력되는 것으로 알고 계시면 됩니다.
 *** default Settings value : #anonymous_enable=YES 
 결과 값이 출력되지 않을 경우 주석처리된 것일 수도 있어 취약으로 진단 
=============================================




[U-21] r 계열 서비스 비활성화
[U-21_START]
=============================================
[+] 해당 서비스가 비활성화되어 있습니다.


[+] xinetd 활성화 서비스 목록
[+] xinetd 디렉토리가 존재하지 않습니다.


[U-21_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 아래의 항목 중 해당사항이 없는경우
 * 취약 조건 : 아래의 항목 중 해당하는 조건이 있는 경우
*********************************************
1. rexec, rlogin, rsh 서비스 활성화
[*] 프로세스 구동여부 더블체크
*********************************************
=============================================




[U-22] cron 파일 소유자 및 권한설정
[U-22_START]
=============================================
[+] /etc/cron.d
drwxr-xr-x. 2 root root 21 Jun 17 14:30 /etc/cron.d

[+] /etc/cron.daily
drwxr-xr-x. 2 root root 6 Aug 10  2021 /etc/cron.daily

[+] /etc/cron.deny
-rw-r--r--. 1 root root 10 Jun 18 14:53 /etc/cron.deny

[+] /etc/cron.hourly
drwxr-xr-x. 2 root root 22 Jun 17 14:30 /etc/cron.hourly

[+] /etc/cron.monthly
drwxr-xr-x. 2 root root 6 Aug 10  2021 /etc/cron.monthly

[+] /etc/cron.weekly
drwxr-xr-x. 2 root root 6 Aug 10  2021 /etc/cron.weekly

[+] /etc/crontab
-rw-r--r--. 1 root root 530 Jun 18 14:02 /etc/crontab

[+] /etc/at.deny
-rw-r--r--. 1 root root 1 Apr  4  2022 /etc/at.deny


[U-22_END]
=============================================
[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 1. : crontab 파일의 other 권한에 읽기, 쓰기 권한이 존재하지 않는 경우
 * 양호 기준 2. : 접근제어파일(*.allow, *.deny) 소유자가 root이고, 권한이 640이하로 설정된 경우
 * 취약 기준 : 양호 기준 1,2 중 하나라도 부합하는 경우
*** cron.deny, cron.allow 둘 다 없는 경우 수정권한은 슈퍼유저(root)만 가능(양호로 진단) ***
=============================================




[U-23] Dos 공격에 취약한 서비스 비활성화
[U-23_START]
=============================================
[+] 1. 현황 : ls -al /etc/xinetd.d
파일이 존재하지 않습니다.

[U-23_END]
=============================================
[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : echo, discard, daytime, chargen 서비스가 비활성화 되어있거나 결과값이 없을경우에 양호
 * 취약 기준 : 미사용 중인 서비스로 구동 중이거나, 불필요하게 서비스가 구동 중인 경우
[*] Sendmail 구동 시 프로세스 출력 값(예시)
  root      29202      1  0 Dec12 ?        00:00:00 sendmail: accepting connections
  smmsp     29213      1  0 Dec12 ?        00:00:00 sendmail: Queue runner@01:00:00 for /var/spool/clientmqueue
 *** 결과 파일이 출력된다는 것은 해당 서비스가 활성화(Active-Running) 상태이기 때문에 출력되는 것으로 알고 계시면 됩니다.
=============================================




[U-24] NFS 서비스 비활성화
[U-24_START]
=============================================
[+] 1. 현황 : nfs|mountd|statd 서비스 확인
root         647       1  0 Jun30 ?        00:00:00 /usr/sbin/nfsdcld
rpcuser      895       1  0 Jun30 ?        00:00:00 /usr/sbin/rpc.statd
root         896       1  0 Jun30 ?        00:00:00 /usr/sbin/rpc.mountd
root        1059       2  0 Jun30 ?        00:00:00 [nfsd]
root        1060       2  0 Jun30 ?        00:00:00 [nfsd]
root        1061       2  0 Jun30 ?        00:00:00 [nfsd]
root        1062       2  0 Jun30 ?        00:00:00 [nfsd]
root        1063       2  0 Jun30 ?        00:00:00 [nfsd]
root        1064       2  0 Jun30 ?        00:00:00 [nfsd]
root        1065       2  0 Jun30 ?        00:00:00 [nfsd]
root        1066       2  0 Jun30 ?        00:00:00 [nfsd]

[+] 2. 참고 : service nfs status 실행(NFS 프로세스의 Status 필드 inactive면 양호) 
Redirecting to /bin/systemctl status nfs.service
Unit nfs.service could not be found.
 

[U-24_END]
=============================================
[+] 2. 참고 : service nfs status 실행(NFS 프로세스의 Status 필드 inactive면 양호) 

[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : 불필요한 NFS 서비스 관련 데몬이 비활성화 되어 있는 경우
 * 취약 기준 : 불필요한 NFS 서비스 관련 데몬이 활성화 되어 있는 경우
=============================================




[U-25] NFS 접근 통제
[U-25_START]
=============================================
showmount -e
Export list for mail.jian.local:
/nfs_share 192.168.10.101,192.168.0.9
=============================================
[+] NFS 서비스가 활성화되어 있습니다.


1.cat /etc/exports
/nfs_share 192.168.0.9(rw,sync,no_subtree_check)
/nfs_share 192.168.10.101(rw,sync,no_subtree_check)
 
2.ls -laL /etc/exports
-rw-r--r--. 1 root root 101 Jun 19 14:53 /etc/exports
[+]NFS 파일(/etc/export 및 /etc/dfs/dfstab)존재함(수동점검)

[U-25_END]
=============================================
[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : NFS 미사용 또는 설정 파일 조회 시 everyone에 대해 제한한 경우
 * 취약 기준 : 1. NFS 사용하며, everyone에 대해 제한하지 않은 경우 / 2. NFS 설정 파일 내에 읽기/쓰기 권한 정의 등의 적절한 접근 통제 설정이 없을 경우 / 3. NFS 설정 파일의 접근권한이 소유자가 root가 아니고, 권한이 644보다 높게 부여된 경우
=============================================




[U-26] automountd 제거
[U-26_START]
=============================================
[+] automountd 와 autofs 가 비활성화 되어있습니다.
[U-26_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 불필요한 autmountd 서비스가 비활성화된 경우
 * 취약 조건 : 취약한 버전의 automountd 서비스가 불필요하게 활성화된 경우 / HP-UX 같은 경우 automount가 활성화된 경우 AUTOFS 값이 1인 경우 취약 
 *** 결과 값이 출력되지 않을 경우 미구동 중인 것으로 판단
=============================================




[U-27] RPC 서비스 확인
[U-27_START]
=============================================
[+] 1. rpc 프로세스 현황
[*] 출력값 존재 시 취약

[+] 2. rpc 서비스 현황
[*] 출력값 존재 시 취약

[+] 3. inetd.conf 확인
파일이 존재하지 않습니다. /etc/inetd.conf
[*] 출력값 존재 시 취약

[U-27_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 양호 : 불필요한 RPC 관련 서비스가 존재하지 않으면 양호 (업무상 사용시 예외)
 취약 : 불필요한 RPC 관련 서비스가 존재하면 취약
 참고 목록 : rpc.cmsd rpc.ttdbserverd sadmind rusersd walld sprayd rstatd rpc.nisd rexd rpc.pcnfsd rpc.statd rpc.ypupdated rpc.rquotad kcms_server cachefsd
=============================================




[U-28] NIS, NIS+ 점검
[U-28_START]
=============================================
[+] NIS 서비스, NIS+ 서비스 활성화 확인
[+] 해당 서비스가 비활성화되어 있습니다.


[U-28_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 아래의 항목 중 해당사항이 없는경우
 * 취약 조건 : 아래의 항목 중 해당하는 조건이 있는 경우
*********************************************
1. NIS, NIS+ 서비스 활성화
[*] 프로세스 구동여부 더블체크
*********************************************
=============================================




[U-29] tftp, talk 서비스 비활성화
[U-29_START]
=============================================
[+] inetd 활성화 서비스 목록
[+] 해당 서비스가 비활성화되어 있습니다.


[+] xinetd 활성화 서비스 목록
[+] xinetd 디렉토리가 존재하지 않습니다.


[U-29_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 아래의 항목 중 해당사항이 없는경우
 * 취약 조건 : 아래의 항목 중 해당하는 조건이 있는 경우
*********************************************
1. tftp, talk, ntalk 서비스가 불필요하게 활성화된 경우
2. finger 서비스 활성화
3. rexec, rlogin, rsh 서비스 활성화
4. DoS 공격에 취약한 echo, discard, daytime, chargen 서비스 활성화
5. NIS, NIS+ 서비스 활성화
[*] 프로세스 구동여부 더블체크
*********************************************
=============================================




[U-30] Sendmail 버전 점검
[U-30_START]
=============================================
[+] Sendamil 서비스가 활성화 중입니다.
*** 기본적으로 비활성화되어있는 서비스로 불필요 여부 확인필요 요망 

[+] Sendmail 버전 정보
[+] /etc/mail/sendmail.cf
DZ8.16.1


[U-30_END]
=============================================
[*] SMTP 포트 확인(참고) 
tcp        0      0 0.0.0.0:25              0.0.0.0:*               LISTEN     

[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : SMTP 서비스 버전이 최신 버전일 경우 또는 금융회사 내부 규정에 따라 패치 검토 및 패치를 수행하고 있는 경우
 * 취약 기준 : SMTP 서비스 버전이 최신이 아닐 경우 또는 금융회사 내부 규정의 패치 관리 절차를 준수하지 않은 경우
 ****** Sendmail Release List ******
  - 8.17.1/8.17.1  2021/08/17
  - 8.16.2/8.16.2 202X/XX/XX
  - 8.16.1/8.16.1 2020/07/05
  - 8.15.2/8.15.2 2015/07/03
  - 8.15.1/8.15.1 2014/12/06
  - 8.14.7/8.14.7 2013/04/21
  - 8.14.6/8.14.6 2012/12/23
 ***********************************
 참고 출처 : https://ftp.sendmail.org/RELEASE_NOTES
 버전정보는 상시로 업데이트 될 수 있으니 진단 진행할 때 마다 체크필요
 *** 결과 파일이 출력된다는 것은 해당 서비스가 활성화(Active-Running) 상태이기 때문에 출력되는 것으로 알고 계시면 됩니다.
=============================================




[U-31] 스팸 메일 릴레이 제한
[U-31_START]
=============================================
[+] Sendamil 서비스가 활성화 중입니다.
*** 기본적으로 비활성화되어있는 서비스로 불필요 여부 확인필요 요망 

[+] Sendmail 버전 정보
DZ8.16.1

[+] /etc/mail/sendmail.cf
R$*			$#error $@ 5.7.1 $: "550 Relaying denied. Proper authentication required."


[U-31_END]
=============================================
[*] SMTP 포트 확인(참고) 
tcp        0      0 0.0.0.0:25              0.0.0.0:*               LISTEN     

[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 1. : sendmail 버전 8.9 이상인 경우 양호(디폴트로 스팸 메일 릴레이 방지 설정이 되어 있음) 
 * 양호 기준 2. : 스팸 메일 릴레이 방지 설정을 했을 경우
 ** 양호 기준 설정 예시 ** 
 R$*                     0error  5.7.1 $: 550 Relaying denied

 * 취약 기준 : 스팸 메일 릴레이 방지 설정이 적용되지 않은 경우(해당 설정이 주석처리 된 경우)

 *** 결과 파일이 출력된다는 것은 해당 서비스가 활성화(Active-Running) 상태이기 때문에 출력되는 것으로 알고 계시면 됩니다.
=============================================




[U-32] 일반사용자의 Sendmail 실행 방지
[U-32_START]
=============================================
[+] Sendamil 서비스가 활성화 중입니다.
*** 기본적으로 비활성화되어있는 서비스로 불필요 여부 확인필요 요망 

[+] /etc/mail/sendmail.cf
O PrivacyOptions=authwarnings,novrfy,noexpn,restrictqrun


[U-32_END]
=============================================
[*] SMTP 포트 확인(참고) 
tcp        0      0 0.0.0.0:25              0.0.0.0:*               LISTEN     

[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : PrivacyOptions 에 restrictqrun 설정 존재하는 경우
 * 취약 기준 : PrivacyOptions 에 restrictqrun 설정 존재하지 않는 경우
 *** 결과 파일이 출력된다는 것은 해당 서비스가 활성화(Active-Running) 상태이기 때문에 출력되는 것으로 알고 계시면 됩니다.
=============================================




[U-33] DNS 보안 버전 패치
[U-33_START]
=============================================
[+] DNS 서비스가 활성화 중입니다.
*** 기본적으로 비활성화되어있는 서비스로 DNS 서비스 활성화 시 필요성 여부 확인필요 요망 

[+] DNS 프로세스 실행 확인
named        816       1  0 Jun30 ?        00:00:02 /usr/sbin/named -u named -c /etc/named.conf

[+] DNS 버전 확인
BIND 9.16.23-RH (Extended Support Version) <id:fde3b1f>

[+] DNS 취약점 쿼리 전송 결과 


[U-33_END]
=============================================
[*] DNS 포트 확인(참고) 
tcp        0      0 127.0.0.1:53            0.0.0.0:*               LISTEN     
tcp        0      0 192.168.10.100:53       0.0.0.0:*               LISTEN     
tcp6       0      0 ::1:53                  :::*                    LISTEN     

[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : 알려진 취약점이 없는 DNS 버전을 사용하는 경우(쿼리 결과 값이 없는 경우 포함)
 * 양호 기준 : dig @localhost +short porttest.dns-oarc.net TXT 명령 결과가 다음과 같은 경우
     z.y.x.w.v.u.t.s.r.q.p.o.n.m.l.k.j.i.h.g.f.e.d.c.b.a.pt.dns-oarc.net.
     IP-of-GOOD is GOOD: 26 queries in 2.0 seconds from 26 ports with std dev 17685.51
 * 취약 기준 :  dig @localhost +short porttest.dns-oarc.net TXT 명령 결과가 다음과 같은 경우
     porttest.y.x.w.v.u.t.s.r.q.p.o.n.m.l.k.j.i.h.g.f.e.d.c.b.a.pt.dns-oarc.net.
     해당서버IP is POOR: 26 queries in 3.6 seconds from 1 ports with std dev 0
=============================================




[U-34] DNS Zone Transfer 설정
[U-34_START]
=============================================
[+] DNS 서비스가 활성화 중입니다.
*** 기본적으로 비활성화되어있는 서비스로 DNS 서비스 활성화 시 필요성 여부 확인필요 요망 

[+] DNS 프로세스 실행 확인
named        816       1  0 Jun30 ?        00:00:02 /usr/sbin/named -u named -c /etc/named.conf

[+] DNS zone Transfer 설정 확인(파일명 하단에 출력값 없으면 양호)
 [*] /etc/named.conf




[U-34_END]
=============================================
[*] DNS 포트 확인(참고) 
tcp        0      0 127.0.0.1:53            0.0.0.0:*               LISTEN     
tcp        0      0 192.168.10.100:53       0.0.0.0:*               LISTEN     
tcp6       0      0 ::1:53                  :::*                    LISTEN     

[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : DNS 서비스 미사용 또는, Zone Transfer를 허가된 사용자에게만 허용한 경우
 * 취약 기준 : DNS 서비스를 사용하며 Zone Transfer를 모든 사용자에게 허용한 경우
=============================================




[U-35] 웹서비스 디렉토리 리스팅 제거
[U-35_START]
=============================================
[+] apache 서비스가 구동중 입니다.
[+] 1. 설정파일 현황
    #   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
    #Options -Indexes -FollowSymLinks
    Options indexes FollowSymLinks
[U-35_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 디렉토리 리스팅이 불가능할 경우
 * 취약 조건 : httpd.conf 파일 내의 Options에서 Indexes 옵션이 있을 경우
=============================================




[U-36] 웹서비스 웹 프로세스 권한 제한
[U-36_START]
=============================================
[+] apache 서비스가 구동중 입니다.
[+] 현황 확인
User apache

Group apache



[+] 미출력 시 미설정
[U-36_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : Apache 프로세스의 계정이 적절하게 설정되어 있을 경우
 * 취약 조건 : Apache 설정 파일인 httpd.conf 파일 내 user, group 설정이 root인 경우
=============================================




[U-37] 웹서비스 상위 디렉토리 접근 금지
[U-37_START]
=============================================
[+] apache 서비스가 구동중 입니다.
참고 : Apache 2.048보다 높은 버전일 경우 양호

[+] 1. 버전확인(rpm -qa | httpd)
httpd (pid 902) already running

[+] 2. 버전확인(dpkg -l | grep apache)

[+] 3. 버전확인(httpd -v)
Server version: Apache/2.4.62 (CentOS Stream)
Server built:   Jan 29 2025 00:00:00

[+] 4. allowoverride 설정 확인 (authconfig | none 옵션 시 양호)
    AllowOverride none
    AllowOverride None
    # AllowOverride controls what directives may be placed in .htaccess files.
    AllowOverride None
    AllowOverride None

[U-37_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : Directory Traversal 취약점이 발견되지 않은 Apache 버전을 사용하고 있을 경우
 * 취약 조건 : Directory Traversal 취약점이 발견된 Apache 버전을 사용하고 있을 경우
=============================================




[U-38] 웹서비스 불필요한 파일 제거
[U-38_START]
=============================================
[+] apache 서비스가 구동중 입니다.

[+] 1. 현황 : manual 디렉토리 없음

[+] 2. 현황 : cgi-bin 디렉토리 없음

[+] 3. 현황 : sample 디렉토리 없음

[U-38_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 불필요한 파일이 존재하지 않을 경우
 * 1. 취약 조건 : 디폴트 cgi-bin이 존재할 경우
 * 2. 취약 조건 : 임시 파일, 백업 파일 등이 존재할 경우
=============================================




[U-39] 웹서비스 링크 사용 금지
[U-39_START]
=============================================
[+] apache 서비스가 구동중 입니다.
[+] 현황 확인
<Directory />
</Directory>
<Directory "/var/www">
</Directory>
<Directory "/var/www/new">
    #   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
    #Options -Indexes -FollowSymLinks
    Options indexes FollowSymLinks
</Directory>
<Directory "/var/www/cgi-bin">
</Directory>

[+] 미출력 시 미설정

[U-39_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 취약 요건에 해당사항이 없는 경우
 * 취약 조건 : 1. Apache Options에 불필요하게 FollowSymLinks 설정이 되어 있는 경우
 * 취약 조건 : 2. Apache Options에 FollowSymLinks 설정이 되어 있고 업무적으로 사용하는 경우라도 중요 디렉토리 혹은 파일에 링크가 설정 되어 있는 경우
 ** 참고 : FollowSymLinks 존재하지 않을 경우 상위 디렉토리에서 상속 받거나, OS 버전에 따라 FollowSymLinks가 없어도 기본 값으로 활성화되어 있을 수 있어 명확하게 비활성화 할 수 있도록 아래와 같이 설정 필요
 ** -FollowSymLinks (Apache 2도 마찬가지) 
=============================================




[U-40] 웹서비스 파일 업로드 및 다운로드 제한
[U-40_START]
=============================================
[+] apache 서비스가 구동중 입니다.
[+] 현황 확인

LimitRequestBody 50000
<Directory />
</Directory>
<Directory "/var/www">
</Directory>
<Directory "/var/www/new">
</Directory>
<Directory "/var/www/cgi-bin">
</Directory>

[+] 미출력 시 미설정
[U-40_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : httpd.conf 파일 내 디렉토리 설정에 LimitRequestBody 값 설정이 되어 있을 경우
 * 취약 조건 : httpd.conf 파일 내 디렉토리 설정에 LimitRequestBody 값 설정이 안되어 있을 경우
=============================================




[U-41] 웹서비스 영역의 분리
[U-41_START]
=============================================
[+] apache 서비스가 구동중 입니다.
[+] 현황 확인
# DocumentRoot: The directory out of which you will serve your
# DocumentRoot "/var/www/html"
DocumentRoot "/var/www/new"
    # access content that does not live under the DocumentRoot.

[+] 미출력 시 미설정
[U-41_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 웹 서비스 경로 중 / 등 기타 업무와 영역이 분리되지 않은 경로 또는 불필요한 경로가 존재하지 않을 경우
 * 취약 조건 : 웹 서비스 경로 중 / 등 기타 업무와 영역이 분리되지 않은 경로 또는 불필요한 경로가 존재하는 경우
=============================================




[U-60] ssh 원격접속 허용
[U-60_START]
=============================================
[+] 1. 현황 : ssh 서비스 확인(PS)
root         788       1  0 Jun30 ?        00:00:00 sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups
root       55858     788  0 10:01 ?        00:00:00 sshd: jian [priv]
jian       55879   55858  0 10:01 ?        00:00:00 sshd: jian@notty
root       55903     788  0 10:01 ?        00:00:00 sshd: jian [priv]
jian       55908   55903  0 10:02 ?        00:00:01 sshd: jian@pts/0

[+] 1-1. 현황 : ssh 서비스 확인
Redirecting to /bin/systemctl status sshd.service
* sshd.service - OpenSSH server daemon
     Loaded: loaded (/usr/lib/systemd/system/sshd.service; enabled; preset: enabled)
     Active: active (running) since Wed 2025-06-25 14:52:48 KST; 6 days ago
       Docs: man:sshd(8)
             man:sshd_config(5)
   Main PID: 788 (sshd)
      Tasks: 1 (limit: 10455)
     Memory: 8.7M
        CPU: 571ms
     CGroup: /system.slice/sshd.service
             `-788 "sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups"

Jun 30 11:59:22 mail.jian.local sshd[41790]: Accepted password for jian from 192.168.10.1 port 53997 ssh2
Jun 30 11:59:22 mail.jian.local sshd[41790]: pam_unix(sshd:session): session opened for user jian(uid=1000) by jian(uid=0)
Jun 30 11:59:48 mail.jian.local sshd[41858]: Accepted password for jian from 192.168.10.1 port 53999 ssh2
Jun 30 11:59:48 mail.jian.local sshd[41858]: pam_unix(sshd:session): session opened for user jian(uid=1000) by jian(uid=0)
Jun 30 16:40:34 mail.jian.local sshd[52604]: Accepted password for jian from 192.168.10.1 port 55485 ssh2
Jun 30 16:40:34 mail.jian.local sshd[52604]: pam_unix(sshd:session): session opened for user jian(uid=1000) by jian(uid=0)
Jul 01 10:01:56 mail.jian.local sshd[55858]: Accepted password for jian from 192.168.10.1 port 56757 ssh2
Jul 01 10:01:56 mail.jian.local sshd[55858]: pam_unix(sshd:session): session opened for user jian(uid=1000) by jian(uid=0)
Jul 01 10:02:01 mail.jian.local sshd[55903]: Accepted password for jian from 192.168.10.1 port 56803 ssh2
Jul 01 10:02:01 mail.jian.local sshd[55903]: pam_unix(sshd:session): session opened for user jian(uid=1000) by jian(uid=0)
 
[+] 1-2. 현황 : ssh 서비스 확인(CentOS7)
Unit ssh.service could not be found.

[U-60_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 :  원격 접속 시 SSH 프로토콜을 사용하는 경우 (※ ssh, telnet이 동시에 설치되어 있는 경우 취약한 것으로 평가됨)
 * 취약 조건 : 원격 접속 시 Telnet, FTP 등 안전하지 않은 프로토콜을 사용하는 경우
=============================================




[U-61] ftp 서비스 확인
[U-61_START]
=============================================
[+] FTP 서비스 활성화 확인 
 [+] FTP 서비스가 활성화 중입니다.
 [+]  vsftpd :  1
 [+]  proftpd :  0
 [*] 활성화(1), 비활성화(0)

 [*] 이외 ftp 확인
root         903       1  0 Jun30 ?        00:00:00 /usr/sbin/vsftpd /etc/vsftpd/vsftpd.conf
jian       55880   55879  0 10:01 ?        00:00:00 /usr/libexec/openssh/sftp-server

[+] SFTP 설정 현황
Subsystem	sftp	/usr/libexec/openssh/sftp-server

[U-61_END]
=============================================
[*] FTP 포트 활성화 확인 
tcp6       0      0 :::21                   :::*                    LISTEN     

[참고 - 진단기준, 결과 값 출력]

** 양호 기준(1),(2) 중 하나라도 부합할 경우 취약으로 진단
 * 양호 기준(1) : FTP 서비스가 비활성화되어 있는 경우
 * 양호 기준(2) : SFTP 서비스가 활성화되어 있는 경우, 사용자 접속 설정이 별도로 들어가있는 경우
** 취약 기준(1),(2),(3) 중 하나라도 해당되는 경우 취약으로 진단
 * 취약 기준(1) : 불필요하게 FTP 서비스가 활성화되어 있는 경우, FTP 서비스가 활성화되어 있는 경우, SFTP 서비스 접속 설정이 별도로 적용되어있지 않는 경우
 * 취약 기준(2) : FTP 서비스가 활성화되어 있는 경우
 * 취약 기준(3) : SFTP 서비스 접속 설정이 별도로 적용되어있지 않는 경우
 *** 결과 파일이 출력된다는 것은 해당 서비스가 활성화(Active-Running) 상태이기 때문에 출력되는 것으로 알고 계시면 됩니다.
 '[+] SFTP 설정 현황'에서 출력되는 설정 값이 주석처리되어있지 않다면 별도 설정적용이 존재하지 않는 것으로 진단(취약) 

=============================================




[U-62] ftp 계정 shell 제한
[U-62_START]
=============================================
[+] FTP 계정 확인 
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin

[U-62_END]
=============================================
[*] FTP 포트 활성화 확인 
tcp6       0      0 :::21                   :::*                    LISTEN     

[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : ftp 계정의 shell 이 /bin/false로 부여되어 있는 경우

=============================================




[U-63] Ftpusers 파일 소유자 및 권한 설정
[U-63_START]
=============================================
[+] FTP 서비스 활성화 확인 
 [+] FTP 서비스가 활성화 중입니다.
 [+]  vsftpd :  1
 [+]  proftpd :  0
 [*] 활성화(1), 비활성화(0)

 [*] 이외 ftp 확인
root         903       1  0 Jun30 ?        00:00:00 /usr/sbin/vsftpd /etc/vsftpd/vsftpd.conf
jian       55880   55879  0 10:01 ?        00:00:00 /usr/libexec/openssh/sftp-server

[+] /etc/ftpusers

[+] 파일이 존재하지 않습니다.
[+] /etc/ftpd/ftpusers

[+] 파일이 존재하지 않습니다.

[+] /etc/vsftpd/ftpusers
-rw-------. 1 root root 135 Jun 18 15:15 /etc/vsftpd/ftpusers

[+] /etc/vsftpd/user_list
-rw-------. 1 root root 375 Jun 18 15:19 /etc/vsftpd/user_list
[+] /etc/vsftpd.ftpusers

[+] 파일이 존재하지 않습니다.
[+] /etc/vsftpd.user_list

[+] 파일이 존재하지 않습니다.

[U-63_END]
=============================================
[*] FTP 포트 활성화 확인 
tcp6       0      0 :::21                   :::*                    LISTEN     

[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : ftpusers 파일의 소유자가 root이고, 권한이 640 이하인 경우
 * 취약 기준 : ftpusers 파일의 소유자가 root가 아니거나, 권한이 640 이하가 아닌 경우
 *** 결과 파일이 출력된다는 것은 해당 서비스가 활성화(Active-Running) 상태이기 때문에 출력되는 것으로 알고 계시면 됩니다.

=============================================




[U-64] Ftpusers 파일 설정
[U-64_START]
=============================================
[+] FTP 서비스 활성화 확인 
 [+] FTP 서비스가 활성화 중입니다.
 [+]  vsftpd :  1
 [+]  proftpd :  0
 [*] 활성화(1), 비활성화(0)

 [*] 이외 ftp 확인
root         903       1  0 Jun30 ?        00:00:00 /usr/sbin/vsftpd /etc/vsftpd/vsftpd.conf
jian       55880   55879  0 10:01 ?        00:00:00 /usr/libexec/openssh/sftp-server

[+] /etc/ftpusers
[+] 파일이 존재하지 않습니다.
[+] /etc/ftpd/ftpusers
[+] 파일이 존재하지 않습니다.

[+] /etc/vsftpd/ftpusers

# Users that are not allowed to login via ftp
root
bin
daemon
adm
lp
sync
shutdown
halt
mail
news
uucp
operator
games
nobody
lynsecure

[+] /etc/vsftpd/user_list

# vsftpd userlist
# If userlist_deny=NO, only allow users in this file
# If userlist_deny=YES (default), never allow users in this file, and
# do not even prompt for a password.
# Note that the default vsftpd pam config also checks /etc/vsftpd/ftpusers
# for users that are denied.
#root
#bin
#daemon
#adm
#lp
#sync
#shutdown
#halt
#mail
#news
#uucp
#operator
#games
#nobody
[+] /etc/vsftpd.ftpusers
[+] 파일이 존재하지 않습니다.
[+] /etc/vsftpd.user_list
[+] 파일이 존재하지 않습니다.

[U-64_END]
=============================================
[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : ftpusers 파일이 존재하고, ftpusers 파일 안에 시스템 계정(root)이 존재할 경우
 * 취약 기준 : ftpusers 파일이 없거나, ftpusers 파일 안에 시스템 계정 미존재 혹은 주석처리 되어 있을 경우
 *** 결과 파일이 출력된다는 것은 해당 서비스가 활성화(Active-Running) 상태이기 때문에 출력되는 것으로 알고 계시면 됩니다.
=============================================




[U-65] at 파일 소유자 및 권한 설정
[U-65_START]
=============================================

[+] /etc/at.deny
-rw-r--r--. 1 root root 1 Apr  4  2022 /etc/at.deny
[+] at 접근제어 파일이 존재하지 않음
[+] at 접근제어 파일이 존재하지 않음

[U-65_END]
=============================================
[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 1. : at 명령어 권한 750 이하 
 * 양호 기준 2. : 접근제어파일(*.allow, *.deny) 소유자가 root이고, 권한이 640이하로 설정된 경우
 * 취약 기준 : 양호 기준 1,2 중 하나라도 부합하는 경우
*** cron.deny, cron.allow 둘 다 없는 경우 수정권한은 슈퍼유저(root)만 가능(양호로 진단) ***
=============================================




[U-66] SNMP 서비스 구동 점검
[U-66_START]
=============================================
[+] SNMP 서비스가 비활성화되어 있습니다.

[U-66_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 : SNMP 서비스를 사용하지 않거나, 사용 목적에 맞게 서비스를 사용하고 있는 경우
 * 취약 : SNMP 서비스를 불필요하게 활성화되어 있는 경우
 *** 결과 파일이 출력된다는 것은 해당 서비스가 활성화(Active-Running) 상태이기 때문에 출력되는 것으로 알고 계시면 됩니다.
=============================================





[U-67] SNMP 서비스 커뮤니티스트링의 복잡성 설정
[U-67_START]
=============================================
[+] SNMP 서비스가 비활성화되어 있습니다.

[U-67_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
양호 조건 1과 2 모두 충족하거나(or) 조건 3만 충족하는 경우 양호로 진단
 * 양호 조건 1 : Commnity String 값이 Public이나 Private로 설정되어있지 않는 경우
 * 양호 조건 2 : Commnity String 값의 복잡도 설정이 적용되어있는 경우(2가지 조합 10자리 이상, 3가지 조합 8자리 이상)
 * 양호 조건 3 : SNMP v3 사용하고 있으며, 비밀번호 복잡도 설정 충족되는 경우
 * 취약      : Community String 값이 Public이나 Private로 설정되어 있거나, 복잡도 충족이 안되는 경우 
 ** SNMPv3 보안설정은 noAuthNoPriv(인증 X, 암호화 X), authNoPriv(인증 O, 암호화 X), authPriv(인증 O, 암호화 O)으로 구분
 *** 결과 파일이 출력된다는 것은 해당 서비스가 활성화(Active-Running) 상태이기 때문에 출력되는 것으로 알고 계시면 됩니다.
=============================================




[U-68] 로그온 시 경고 메시지 제공
[U-68_START]
=============================================
[+] 1. 현황 : issue 확인
-rw-r--r--. 1 root root 23 Apr  9 04:18 /etc/issue

\S
Kernel \r on an \m


[+] 2. 현황 : issue.net 확인 
-rw-r--r--. 1 root root 22 Apr  9 04:18 /etc/issue.net

\S
Kernel \r on an \m

[+] 3. 현황 : /etc/motd 확인
-rw-r--r--. 1 root root 0 Jun 23  2020 /etc/motd


[U-68_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 시스템 사용 주의사항을 출력하는 경우
 * 취약 조건 : 시스템 사용 주의사항 미출력 또는 표시 문구 내에 시스템 버전 정보가 노출되는 경우
=============================================




[U-69] NFS 설정파일 접근 제한
[U-69_START]
=============================================
[+] NFS 서비스가 활성화되어 있습니다.


ls -laL /etc/exports
-rw-r--r--. 1 root root 101 Jun 19 14:53 /etc/exports
[+]NFS 파일(/etc/export 및 /etc/dfs/dfstab)존재함(수동점검)

[U-69_END]
=============================================
[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : /etc/dfs/dfstab 가 없거나 퍼미션이 644이하인 경우
=============================================




[U-70] expn, vrfy 명령어 제한
[U-70_START]
=============================================
[+] Sendmail 서비스가 활성화 중입니다.
*** 기본적으로 비활성화되어있는 서비스로 불필요 여부 확인 필요 요망 

[+] /etc/mail/sendmail.cf
O PrivacyOptions=authwarnings,novrfy,noexpn,restrictqrun

[U-70_END]
=============================================
[*] SMTP 포트 확인(참고) 
tcp        0      0 0.0.0.0:25              0.0.0.0:*               LISTEN     

[참고 - 진단기준, 결과 값 출력]

 * 양호 기준 : noexpn과 novrfy 또는 goaway가 설정되어있는 경우
 * 취약 기준 : noexpn과 novrfy 또는 goaway가 설정되어있지 않는 경우
 *** 결과 파일이 출력된다는 것은 해당 서비스가 활성화(Active-Running) 상태이기 때문에 출력되는 것으로 알고 계시면 됩니다.
=============================================




[U-71] Apache 웹 서비스 정보 숨김
[U-71_START]
=============================================
[+] apache 서비스가 구동중 입니다.
[+] 현황 확인
ServerTokens Prod
ServerSignature Off
[U-71_END]
=============================================
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : ServerTokens Prod, ServerSignature Off로 설정되어있는 경우
 * 취약 조건 : ServerTokens Prod, ServerSignature Off로 설정되어있지 않은 경우
 * 참고 : 서비스명 + 버전 정보가 노출되는 경우 취약
=============================================




[U-42] 최신 보안패치 및 벤더 권고사항 적용
[U-42_START]
=============================================
[+] 1. 현황 : 패치 확인
kernel-core-5.14.0-39.el9.x86_64
kernel-modules-5.14.0-39.el9.x86_64
kernel-5.14.0-39.el9.x86_64
kernel-tools-libs-5.14.0-590.el9.x86_64
kernel-modules-core-5.14.0-590.el9.x86_64
kernel-core-5.14.0-590.el9.x86_64
kernel-modules-5.14.0-590.el9.x86_64
kernel-5.14.0-590.el9.x86_64
kernel-tools-5.14.0-590.el9.x86_64

[+] 2. 현황 : uname -r
5.14.0-590.el9.x86_64

[+] 3. OS버전 확인
Operating System: CentOS Stream 9

=============================================
[U-42_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 패치 적용 정책을 수립하여 주기적으로 패치관리를 하고 있으며, 패치 관련 내용을 확인하고 적용했을 경우
 * 취약 조건 : 패치 적용 정책을 수립하지 않고 주기적으로 패치관리를 하지 않거나 패치 관련 내용을 확인하지 않고 적용하지 않았을 경우
=============================================




[U-43] 로그의 정기적 검토 및 보고
[U-43_START]
=============================================
[*] 인터뷰 필요
=============================================
[U-43_END]
[참고 - 진단기준, 결과 값 출력]
 * 양호 조건 : 로그 기록에 대해 정기적 검토, 분석, 보고서 작성 및 보고 등의 절차를 수행하고 있을 경우
 * 취약 조건 : 로그 기록에 대해 정기적 검토가 이루어지지 않을 경우
=============================================




[U-72] 정책에 따른 시스템 로깅 설정
[U-72_START]
=============================================
[+] 1. 현황 : syslog (rsyslog)
root         893       1  0 Jun30 ?        00:00:14 /usr/sbin/rsyslogd -n
[+] 1-2. 현황 : /etc/syslog.conf (/etc/rsyslog.conf)여부
[+] 파일이 존재하지 않습니다.

[+] 1-2. 현황 : /etc/syslog.conf (/etc/rsyslog.conf)여부
[+] /etc/rsyslog.conf
# rsyslog configuration file

# For more information see /usr/share/doc/rsyslog-*/rsyslog_conf.html
# or latest version online at http://www.rsyslog.com/doc/rsyslog_conf.html 
# If you experience problems, see http://www.rsyslog.com/doc/troubleshoot.html

#### GLOBAL DIRECTIVES ####

# Where to place auxiliary files
global(workDirectory="/var/lib/rsyslog")

# Use default timestamp format
module(load="builtin:omfile" Template="RSYSLOG_TraditionalFileFormat")

#### MODULES ####

module(load="imuxsock" 	  # provides support for local system logging (e.g. via logger command)
       SysSock.Use="off") # Turn off message reception via local log socket; 
			  # local messages are retrieved through imjournal now.
module(load="imjournal" 	    # provides access to the systemd journal
       UsePid="system" # PID nummber is retrieved as the ID of the process the journal entry originates from
       FileCreateMode="0644" # Set the access permissions for the state file
       StateFile="imjournal.state") # File to store the position in the journal
#module(load="imklog") # reads kernel messages (the same are read from journald)
#module(load="immark") # provides --MARK-- message capability

# Include all config files in /etc/rsyslog.d/
include(file="/etc/rsyslog.d/*.conf" mode="optional")

# Provides UDP syslog reception
# for parameters see http://www.rsyslog.com/doc/imudp.html
#module(load="imudp") # needs to be done just once
#input(type="imudp" port="514")

# Provides TCP syslog reception
# for parameters see http://www.rsyslog.com/doc/imtcp.html
#module(load="imtcp") # needs to be done just once
#input(type="imtcp" port="514")

#### RULES ####

# Log all kernel messages to the console.
# Logging much else clutters up the screen.
#kern.*                                                 /dev/console

# Log anything (except mail) of level info or higher.
# Don't log private authentication messages!
*.info;mail.none;authpriv.none;cron.none                /var/log/messages

# The authpriv file has restricted access.
authpriv.*                                              /var/log/secure

# Log all the mail messages in one place.
mail.*                                                  -/var/log/maillog


# Log cron stuff
cron.*                                                  /var/log/cron

# Everybody gets emergency messages
*.emerg                                                 :omusrmsg:*

# Save news errors of level crit and higher in a special file.
uucp,news.crit                                          /var/log/spooler

# Save boot messages also to boot.log
local7.*                                                /var/log/boot.log


# ### sample forwarding rule ###
#action(type="omfwd"  
# # An on-disk queue is created for this action. If the remote host is
# # down, messages are spooled to disk and sent when it is up again.
#queue.filename="fwdRule1"       # unique name prefix for spool files
#queue.maxdiskspace="1g"         # 1gb space limit (use as much as possible)
#queue.saveonshutdown="on"       # save messages to disk on shutdown
#queue.type="LinkedList"         # run asynchronously
#action.resumeRetryCount="-1"    # infinite retries if host is down
# # Remote Logging (we use TCP for reliable delivery)
# # remote_host is: name/ip, e.g. 192.168.0.1, port optional e.g. 10514
#Target="remote_host" Port="XXX" Protocol="tcp")
[+] 1-3. [Ubuntu]현황 : /etc/rsyslog.d/50-default.conf 여부
[+] /etc/rsyslog.conf 파일 없음

=============================================
[U-72_END]
[참고 - 진단기준, 결과 값 출력]
[*] 판단기준(양호) : 1. syslog 로그 기록 정책이 내부 정책에 부합하게 설정되어 있는 경우
[*] 판단기준(양호) : 2. syslog 설정에서 auth 또는 authpriv 가 활성화된 경우 (su 명령 로그)
[*] 판단기준(취약) : 1. syslog 로그 기록 정책이 내부 정책에 부합하게 설정되지 않은 경우
[*] 판단기준(취약) : 2. syslog 설정에서 auth 또는 authpriv 가 활성화되지 않은 경우(su 명령 로그)

=============================================




☞ UNIX 스크립트 작업이 완료되었습니다.

☞ 스크립트 결과 파일을 보안담당자에게 전달 바랍니다.
☞ 스크립트 관련 오류 및 문의사항은 린시큐어 직원에게 부탁드립니다.
☞ 감사합니다.
======================================================================

----------------------------------------------------------------------
Reference info.
----------------------------------------------------------------------

======================================================================
                            INFO_CHKSTART
======================================================================

======================================================================
                    System Information Query Start
======================================================================

[Kernel Information]
Linux mail.jian.local 5.14.0-590.el9.x86_64 #1 SMP PREEMPT_DYNAMIC Fri May 30 21:16:05 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux

[IP Information]
ens160: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.10.100  netmask 255.255.255.0  broadcast 192.168.10.255
        inet6 fe80::20c:29ff:febe:3422  prefixlen 64  scopeid 0x20<link>
        ether 00:0c:29:be:34:22  txqueuelen 1000  (Ethernet)
        RX packets 24147  bytes 7978420 (7.6 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 44144  bytes 28851688 (27.5 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 1434  bytes 102562 (100.1 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 1434  bytes 102562 (100.1 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0


[Network Status]
Active Internet connections (servers and established)
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:25              0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:953           0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:2049            0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:53            0.0.0.0:*               LISTEN     
tcp        0      0 192.168.10.100:53       0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:39767           0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:44869           0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:20048           0.0.0.0:*               LISTEN     
tcp        0      0 192.168.10.100:22       192.168.10.1:56757      ESTABLISHED
tcp        0      0 192.168.10.100:22       192.168.10.1:56803      ESTABLISHED
tcp6       0      0 ::1:53                  :::*                    LISTEN     
tcp6       0      0 :::80                   :::*                    LISTEN     
tcp6       0      0 :::111                  :::*                    LISTEN     
tcp6       0      0 :::22                   :::*                    LISTEN     
tcp6       0      0 :::21                   :::*                    LISTEN     
tcp6       0      0 :::2049                 :::*                    LISTEN     
tcp6       0      0 ::1:953                 :::*                    LISTEN     
tcp6       0      0 :::20048                :::*                    LISTEN     
tcp6       0      0 :::53861                :::*                    LISTEN     
tcp6       0      0 :::33293                :::*                    LISTEN     
udp        0      0 192.168.10.100:68       192.168.10.254:67       ESTABLISHED
Active UNIX domain sockets (servers and established)
unix  2      [ ACC ]     STREAM     LISTENING     28283    /run/gssproxy.sock
unix  2      [ ACC ]     STREAM     LISTENING     7121144  /run/user/1000/systemd/private
unix  2      [ ACC ]     STREAM     LISTENING     7121156  /run/user/1000/bus
unix  2      [ ACC ]     STREAM     LISTENING     23671    /run/systemd/private
unix  2      [ ACC ]     STREAM     LISTENING     23684    /run/lvm/lvmpolld.socket
unix  2      [ ACC ]     STREAM     LISTENING     23686    /run/rpcbind.sock
unix  2      [ ACC ]     SEQPACKET  LISTENING     23696    /run/systemd/coredump
unix  2      [ ACC ]     SEQPACKET  LISTENING     23698    /run/udev/control
unix  2      [ ACC ]     STREAM     LISTENING     16339    /run/systemd/userdb/io.systemd.DynamicUser
unix  2      [ ACC ]     STREAM     LISTENING     16340    /run/systemd/io.system.ManagedOOM
unix  2      [ ACC ]     STREAM     LISTENING     16351    /run/systemd/journal/stdout
unix  2      [ ACC ]     STREAM     LISTENING     18978    /run/systemd/journal/io.systemd.journal
unix  2      [ ACC ]     STREAM     LISTENING     27675    @ISCSID_UIP_ABSTRACT_NAMESPACE
unix  2      [ ACC ]     STREAM     LISTENING     28282    /var/lib/gssproxy/default.sock
unix  2      [ ACC ]     STREAM     LISTENING     31439    /etc/httpd/run/cgisock.902
unix  2      [ ACC ]     STREAM     LISTENING     27673    /run/dbus/system_bus_socket
unix  2      [ ACC ]     STREAM     LISTENING     27676    /run/.heim_org.h5l.kcm-socket
unix  2      [ ACC ]     STREAM     LISTENING     27722    /var/run/lsm/ipc/sim
unix  2      [ ACC ]     STREAM     LISTENING     27723    /var/run/lsm/ipc/simc
unix  2      [ ACC ]     STREAM     LISTENING     27745    /var/run/mcelog-client
unix  2      [ ACC ]     STREAM     LISTENING     27674    @ISCSIADM_ABSTRACT_NAMESPACE
unix  2      [ ACC ]     STREAM     LISTENING     28702    /var/run/vmware/guestServicePipe
Active Bluetooth connections (servers and established)

[Routing Information]
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
0.0.0.0         192.168.10.2    0.0.0.0         UG        0 0          0 ens160
192.168.10.0    0.0.0.0         255.255.255.0   U         0 0          0 ens160

[Process Status]
UID          PID    PPID  C STIME TTY          TIME CMD
root           1       0  0 Jun30 ?        00:00:56 /usr/lib/systemd/systemd rhgb --switched-root --system --deserialize 31
root           2       0  0 Jun30 ?        00:00:00 [kthreadd]
root           3       2  0 Jun30 ?        00:00:00 [pool_workqueue_]
root           4       2  0 Jun30 ?        00:00:00 [kworker/R-rcu_g]
root           5       2  0 Jun30 ?        00:00:00 [kworker/R-sync_]
root           6       2  0 Jun30 ?        00:00:00 [kworker/R-slub_]
root           7       2  0 Jun30 ?        00:00:00 [kworker/R-netns]
root           9       2  0 Jun30 ?        00:00:00 [kworker/0:0H-events_highpri]
root          11       2  0 Jun30 ?        00:00:00 [kworker/R-mm_pe]
root          12       2  0 Jun30 ?        00:00:00 [kworker/u512:1-netns]
root          13       2  0 Jun30 ?        00:00:00 [rcu_tasks_kthre]
root          14       2  0 Jun30 ?        00:00:00 [rcu_tasks_rude_]
root          15       2  0 Jun30 ?        00:00:00 [rcu_tasks_trace]
root          16       2  0 Jun30 ?        00:00:05 [ksoftirqd/0]
root          17       2  0 Jun30 ?        00:00:03 [rcu_preempt]
root          18       2  0 Jun30 ?        00:00:00 [rcu_exp_par_gp_]
root          19       2  0 Jun30 ?        00:00:00 [rcu_exp_gp_kthr]
root          20       2  0 Jun30 ?        00:00:00 [migration/0]
root          21       2  0 Jun30 ?        00:00:00 [idle_inject/0]
root          23       2  0 Jun30 ?        00:00:00 [cpuhp/0]
root          24       2  0 Jun30 ?        00:00:00 [cpuhp/1]
root          25       2  0 Jun30 ?        00:00:00 [idle_inject/1]
root          26       2  0 Jun30 ?        00:00:00 [migration/1]
root          27       2  0 Jun30 ?        00:00:03 [ksoftirqd/1]
root          34       2  0 Jun30 ?        00:00:00 [kdevtmpfs]
root          35       2  0 Jun30 ?        00:00:00 [kworker/R-inet_]
root          36       2  0 Jun30 ?        00:00:00 [kauditd]
root          37       2  0 Jun30 ?        00:00:00 [khungtaskd]
root          39       2  0 Jun30 ?        00:00:00 [oom_reaper]
root          40       2  0 Jun30 ?        00:00:00 [kworker/R-write]
root          41       2  0 Jun30 ?        00:00:01 [kcompactd0]
root          42       2  0 Jun30 ?        00:00:00 [ksmd]
root          43       2  0 Jun30 ?        00:00:02 [khugepaged]
root          44       2  0 Jun30 ?        00:00:00 [kworker/R-crypt]
root          45       2  0 Jun30 ?        00:00:00 [kworker/R-kinte]
root          46       2  0 Jun30 ?        00:00:00 [kworker/R-kbloc]
root          47       2  0 Jun30 ?        00:00:00 [irq/9-acpi]
root          49       2  0 Jun30 ?        00:00:00 [kworker/R-tpm_d]
root          50       2  0 Jun30 ?        00:00:00 [kworker/R-md]
root          51       2  0 Jun30 ?        00:00:00 [kworker/R-md_bi]
root          52       2  0 Jun30 ?        00:00:00 [kworker/R-edac-]
root          53       2  0 Jun30 ?        00:00:00 [watchdogd]
root          54       2  0 Jun30 ?        00:00:00 [kworker/1:1H-kblockd]
root          55       2  0 Jun30 ?        00:00:00 [kswapd0]
root          72       2  0 Jun30 ?        00:00:00 [kworker/R-kthro]
root          76       2  0 Jun30 ?        00:00:00 [irq/24-pciehp]
root          77       2  0 Jun30 ?        00:00:00 [irq/25-pciehp]
root          78       2  0 Jun30 ?        00:00:00 [irq/26-pciehp]
root          79       2  0 Jun30 ?        00:00:00 [irq/27-pciehp]
root          80       2  0 Jun30 ?        00:00:00 [irq/28-pciehp]
root          81       2  0 Jun30 ?        00:00:00 [irq/29-pciehp]
root          82       2  0 Jun30 ?        00:00:00 [irq/30-pciehp]
root          83       2  0 Jun30 ?        00:00:00 [irq/31-pciehp]
root          84       2  0 Jun30 ?        00:00:00 [irq/32-pciehp]
root          85       2  0 Jun30 ?        00:00:00 [irq/33-pciehp]
root          86       2  0 Jun30 ?        00:00:00 [irq/34-pciehp]
root          87       2  0 Jun30 ?        00:00:00 [irq/35-pciehp]
root          88       2  0 Jun30 ?        00:00:00 [irq/36-pciehp]
root          89       2  0 Jun30 ?        00:00:00 [irq/37-pciehp]
root          90       2  0 Jun30 ?        00:00:00 [irq/38-pciehp]
root          91       2  0 Jun30 ?        00:00:00 [irq/39-pciehp]
root          92       2  0 Jun30 ?        00:00:00 [irq/40-pciehp]
root          93       2  0 Jun30 ?        00:00:00 [irq/41-pciehp]
root          94       2  0 Jun30 ?        00:00:00 [irq/42-pciehp]
root          95       2  0 Jun30 ?        00:00:00 [irq/43-pciehp]
root          96       2  0 Jun30 ?        00:00:00 [irq/44-pciehp]
root          97       2  0 Jun30 ?        00:00:00 [irq/45-pciehp]
root          98       2  0 Jun30 ?        00:00:00 [irq/46-pciehp]
root          99       2  0 Jun30 ?        00:00:00 [irq/47-pciehp]
root         100       2  0 Jun30 ?        00:00:00 [irq/48-pciehp]
root         101       2  0 Jun30 ?        00:00:00 [irq/49-pciehp]
root         102       2  0 Jun30 ?        00:00:00 [irq/50-pciehp]
root         103       2  0 Jun30 ?        00:00:00 [irq/51-pciehp]
root         104       2  0 Jun30 ?        00:00:00 [irq/52-pciehp]
root         105       2  0 Jun30 ?        00:00:00 [irq/53-pciehp]
root         106       2  0 Jun30 ?        00:00:00 [irq/54-pciehp]
root         107       2  0 Jun30 ?        00:00:00 [irq/55-pciehp]
root         108       2  0 Jun30 ?        00:00:00 [kworker/R-acpi_]
root         109       2  0 Jun30 ?        00:00:00 [kworker/R-kmpat]
root         110       2  0 Jun30 ?        00:00:00 [kworker/R-kalua]
root         112       2  0 Jun30 ?        00:00:00 [kworker/R-mld]
root         113       2  0 Jun30 ?        00:00:00 [kworker/R-ipv6_]
root         118       2  0 Jun30 ?        00:00:00 [kworker/R-kstrp]
root         124       2  0 Jun30 ?        00:00:00 [kworker/u515:0]
root         125       2  0 Jun30 ?        00:00:00 [kworker/u516:0]
root         126       2  0 Jun30 ?        00:00:00 [kworker/u517:0]
root         271       2  0 Jun30 ?        00:00:00 [kworker/0:1H-kblockd]
root         413       2  0 Jun30 ?        00:00:00 [kworker/R-nvme-]
root         415       2  0 Jun30 ?        00:00:00 [kworker/R-nvme-]
root         417       2  0 Jun30 ?        00:00:00 [kworker/R-nvme-]
root         418       2  0 Jun30 ?        00:00:00 [kworker/R-nvme-]
root         420       2  0 Jun30 ?        00:00:00 [kworker/R-ata_s]
root         421       2  0 Jun30 ?        00:00:00 [scsi_eh_0]
root         422       2  0 Jun30 ?        00:00:00 [kworker/R-scsi_]
root         423       2  0 Jun30 ?        00:00:00 [scsi_eh_1]
root         424       2  0 Jun30 ?        00:00:00 [kworker/R-scsi_]
root         427       2  0 Jun30 ?        00:00:00 [irq/16-vmwgfx]
root         428       2  0 Jun30 ?        00:00:00 [kworker/R-ttm]
root         443       2  0 Jun30 ?        00:00:00 [kworker/1:2H-kblockd]
root         455       2  0 Jun30 ?        00:00:00 [kworker/R-xfsal]
root         456       2  0 Jun30 ?        00:00:00 [kworker/R-xfs_m]
root         457       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-b]
root         458       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-c]
root         459       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-r]
root         460       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-b]
root         461       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-i]
root         462       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-l]
root         463       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-c]
root         464       2  0 Jun30 ?        00:00:16 [xfsaild/nvme0n1]
root         556       1  0 Jun30 ?        00:00:07 /usr/lib/systemd/systemd-journald
root         564       2  0 Jun30 ?        00:00:00 [kworker/R-rpcio]
root         565       2  0 Jun30 ?        00:00:00 [kworker/R-xprti]
root         572       1  0 Jun30 ?        00:00:00 /usr/lib/systemd/systemd-udevd
root         599       2  0 Jun30 ?        00:00:01 [irq/75-vmw_vmci]
root         600       2  0 Jun30 ?        00:00:00 [irq/76-vmw_vmci]
root         601       2  0 Jun30 ?        00:00:00 [irq/77-vmw_vmci]
root         623       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-b]
root         624       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-b]
root         625       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-c]
root         626       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-c]
root         627       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-r]
root         628       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-r]
root         629       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-b]
root         630       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-b]
root         631       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-i]
root         632       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-i]
root         633       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-l]
root         634       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-c]
root         635       2  0 Jun30 ?        00:00:00 [xfsaild/nvme0n1]
root         636       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-l]
root         637       2  0 Jun30 ?        00:00:00 [kworker/R-xfs-c]
root         638       2  0 Jun30 ?        00:00:15 [xfsaild/nvme0n1]
rpc          644       1  0 Jun30 ?        00:00:00 /usr/bin/rpcbind -w -f
root         647       1  0 Jun30 ?        00:00:00 /usr/sbin/nfsdcld
root         648       1  0 Jun30 ?        00:00:00 /usr/sbin/rpc.idmapd
root         649       1  0 Jun30 ?        00:00:02 /sbin/auditd
root         651     649  0 Jun30 ?        00:00:00 /usr/sbin/sedispatch
dbus         677       1  0 Jun30 ?        00:00:00 /usr/bin/dbus-broker-launch --scope system --audit
dbus         678     677  0 Jun30 ?        00:00:13 dbus-broker --log 4 --controller 9 --machine-id c41ad224b687452ba82cf3d1fb24d946 --max-bytes 536870912 --max-fds 4096 --max-matches 131072 --audit
root         681       1  0 Jun30 ?        00:00:00 /usr/bin/python3 -s /usr/sbin/firewalld --nofork --nopid
root         682       1  0 Jun30 ?        00:00:05 /usr/sbin/irqbalance
libstor+     683       1  0 Jun30 ?        00:00:00 /usr/bin/lsmd -d
root         684       1  0 Jun30 ?        00:00:00 /usr/sbin/mcelog --daemon --foreground
root         686       1  0 Jun30 ?        00:00:12 /usr/lib/systemd/systemd-logind
root         688       1  0 Jun30 ?        00:00:00 /usr/bin/VGAuthService -s
root         689       1  0 Jun30 ?        00:03:27 /usr/bin/vmtoolsd
chrony       698       1  0 Jun30 ?        00:00:00 /usr/sbin/chronyd -F 2
root         753       1  0 Jun30 ?        00:00:07 /usr/sbin/NetworkManager --no-daemon
root         788       1  0 Jun30 ?        00:00:00 sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups
root         789       1  0 Jun30 ?        00:00:00 /usr/sbin/gssproxy -D
named        816       1  0 Jun30 ?        00:00:02 /usr/sbin/named -u named -c /etc/named.conf
polkitd      876       1  0 Jun30 ?        00:00:03 /usr/lib/polkit-1/polkitd --no-debug
root         893       1  0 Jun30 ?        00:00:14 /usr/sbin/rsyslogd -n
rpcuser      895       1  0 Jun30 ?        00:00:00 /usr/sbin/rpc.statd
root         896       1  0 Jun30 ?        00:00:00 /usr/sbin/rpc.mountd
root         902       1  0 Jun30 ?        00:00:07 /usr/sbin/httpd -DFOREGROUND
root         903       1  0 Jun30 ?        00:00:00 /usr/sbin/vsftpd /etc/vsftpd/vsftpd.conf
root         918       1  0 Jun30 ?        00:00:00 /usr/sbin/atd -f
root         921       1  0 Jun30 ?        00:00:01 /usr/sbin/crond -n
root         939       1  0 Jun30 tty1     00:00:00 /sbin/agetty -o -p -- \u --noclear - linux
root         954       2  0 Jun30 ?        00:00:00 [kworker/R-ib-co]
root         957       2  0 Jun30 ?        00:00:00 [kworker/R-ib-co]
root         959       2  0 Jun30 ?        00:00:00 [kworker/R-ib_mc]
root         960       2  0 Jun30 ?        00:00:00 [kworker/R-ib_nl]
root         971       2  0 Jun30 ?        00:00:00 [kworker/R-iw_cm]
root         976       2  0 Jun30 ?        00:00:00 [kworker/R-rdma_]
root         993       2  0 Jun30 ?        00:00:00 [lockd]
root        1059       2  0 Jun30 ?        00:00:00 [nfsd]
root        1060       2  0 Jun30 ?        00:00:00 [nfsd]
root        1061       2  0 Jun30 ?        00:00:00 [nfsd]
root        1062       2  0 Jun30 ?        00:00:00 [nfsd]
root        1063       2  0 Jun30 ?        00:00:00 [nfsd]
root        1064       2  0 Jun30 ?        00:00:00 [nfsd]
root        1065       2  0 Jun30 ?        00:00:00 [nfsd]
root        1066       2  0 Jun30 ?        00:00:00 [nfsd]
apache      1168     902  0 Jun30 ?        00:00:00 /usr/sbin/httpd -DFOREGROUND
apache      1169     902  0 Jun30 ?        00:00:27 /usr/sbin/httpd -DFOREGROUND
apache      1170     902  0 Jun30 ?        00:00:25 /usr/sbin/httpd -DFOREGROUND
apache      1190     902  0 Jun30 ?        00:00:24 /usr/sbin/httpd -DFOREGROUND
root        2207       2  0 Jun30 ?        00:00:00 [kworker/R-tls-s]
root       55759       2  0 10:01 ?        00:00:00 [kworker/u512:2-gid-cache-wq]
root       55791       1  0 10:01 ?        00:00:01 sendmail: accepting connections
smmsp      55798       1  0 10:01 ?        00:00:00 sendmail: Queue runner@01:00:00 for /var/spool/clientmqueue
root       55858     788  0 10:01 ?        00:00:00 sshd: jian [priv]
jian       55864       1  0 10:01 ?        00:00:00 /usr/lib/systemd/systemd --user
jian       55866   55864  0 10:01 ?        00:00:00 (sd-pam)
jian       55879   55858  0 10:01 ?        00:00:00 sshd: jian@notty
jian       55880   55879  0 10:01 ?        00:00:00 /usr/libexec/openssh/sftp-server
root       55903     788  0 10:01 ?        00:00:00 sshd: jian [priv]
jian       55908   55903  0 10:02 ?        00:00:01 sshd: jian@pts/0
jian       55909   55908  0 10:02 pts/0    00:00:00 -bash
root       55961   55909  0 10:02 pts/0    00:00:00 sudo su
root       55965   55961  0 10:02 pts/0    00:00:00 su
root       55966   55965  0 10:02 pts/0    00:00:00 bash
root       84531       2  0 14:46 ?        00:00:06 [kworker/1:3-cgroup_destroy]
root       87903       2  0 15:37 ?        00:00:00 [kworker/u514:3-events_unbound]
root       87913       2  0 15:38 ?        00:00:00 [kworker/0:4-events]
root       87930       2  0 15:38 ?        00:00:00 [kworker/u513:1-events_unbound]
root       88043       2  0 15:40 ?        00:00:01 [kworker/1:0-events]
root       88106       2  0 15:42 ?        00:00:00 [kworker/u514:2-events_unbound]
root       88130       2  0 15:43 ?        00:00:00 [kworker/0:2-ata_sff]
root       89003       2  0 15:44 ?        00:00:00 [kworker/0:3-ipv6_addrconf]
root       89004       2  0 15:44 ?        00:00:00 [kworker/u513:4-xfs-cil/nvme0n1p5]
root       89046       2  0 15:45 ?        00:00:01 [kworker/1:2-cgroup_destroy]
root       89127       2  0 15:48 ?        00:00:00 [kworker/u514:0-events_unbound]
root       90049       2  0 15:51 ?        00:00:00 [kworker/1:1-events]
root       90065       2  0 15:51 ?        00:00:00 [kworker/u513:0-events_unbound]
root       90088       2  0 15:52 ?        00:00:00 [kworker/0:0-events]
root       90098       2  0 15:53 ?        00:00:00 [kworker/1:4-cgroup_destroy]
root       90138       2  0 15:54 ?        00:00:00 [kworker/0:1]
root       90139       2  0 15:54 ?        00:00:00 [kworker/u514:1]
root       91056   55966  1 15:56 pts/0    00:00:00 bash ./2025_Unix_1.6_??????.sh
root       91906       1  0 15:56 ?        00:00:00 /usr/lib/systemd/systemd-hostnamed
root       91916   91056  0 15:56 pts/0    00:00:00 ps -ef

[User Environment]
SHELL=/bin/bash
SUDO_GID=1000
HOSTNAME=mail.jian.local
HISTSIZE=1000
SUDO_COMMAND=/bin/su
SUDO_USER=jian
PWD=/home/jian
LOGNAME=root
HOME=/root
LANG=C
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:
SHELL_SWITCHED=1
TERM=xterm
LESSOPEN=||/usr/bin/lesspipe.sh %s
USER=root
SHLVL=2
DEBUGINFOD_URLS=https://debuginfod.centos.org/ 
DEBUGINFOD_IMA_CERT_PATH=/etc/keys/ima:
which_declare=declare -f
PATH=/root/.local/bin:/root/bin:/sbin:/bin:/usr/sbin:/usr/bin
SUDO_UID=1000
MAIL=/var/spool/mail/jian
OLDPWD=/home/jian/test
BASH_FUNC_which%%=() {  ( alias;
 eval ${which_declare} ) | /usr/bin/which --tty-only --read-alias --read-functions --show-tilde --show-dot $@
}
_=/bin/env

======================================================================
                     System Information Query End
======================================================================

======================================================================
                             INFO_CHKEND
======================================================================

